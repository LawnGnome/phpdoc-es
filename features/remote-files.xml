<?xml version="1.0" encoding="utf-8"?>
<!-- EN-Revision: 324522 Maintainer: hcrow Status: ready -->
 <chapter xml:id="features.remote-files" xmlns="http://docbook.org/ns/docbook">
  <title>Usando archivos remotos</title>

  <para>
   Siempre que <option>allow_url_fopen</option> este habilitado en
   &php.ini;, se pueden usar URLs <acronym>HTTP</acronym> y <acronym>FTP</acronym>
   con la mayoría de las funciones que toman un nombre de archivo como
   parámetro. Además, las URLs pueden ser usadas con las declaraciones 
   <link linkend="function.include"><literal>include</literal></link>, <link linkend="function.include-once"><literal>include_once</literal></link>, 
   <link linkend="function.require"><literal>require</literal></link> y <link linkend="function.require-once"><literal>require_once</literal></link>
   (desde PHP 5.2.0, <option>allow_url_include</option> debe ser habilitado
   para esto).
   Ver <xref linkend="wrappers"/> para más información de los protocolos
   soportados por PHP.
  </para>
  <note>
   <para>
   En PHP 4.0.3 y anteriores, con el fin de usar capas de URL, se
   requirió de configurar PHP usando la opción de configuración
   <option>--enable-url-fopen-wrapper</option>.
   </para>
  </note>
  <para>
   <note>
    <para>
     Las versiones Windows de PHP más nuevas a la PHP 4.3
     no soportan acceso remoto a los archivos por las siguientes funciones:
     <link linkend="function.include"><literal>include</literal></link>, <link linkend="function.include-once"><literal>include_once</literal></link>,
     <link linkend="function.require"><literal>require</literal></link>, <link linkend="function.require-once"><literal>require_once</literal></link>,
     y las funciones imagecreatefromXXX en la extensión 
     <xref linkend="ref.image"/>
    </para>
   </note>
  </para>
  <para>
   Por ejemplo, se puede usar esto para abrir un archivo en un web server remoto,
   analizar la salida de los datos que se quieren, y entonces usar esos
   datos en una consulta a la base de datos, o simplemente para mostrarlos
   en un estilo que coincida con el resto del sitio web.
  </para>
  <para>
   <example>
    <title>Obteniendo el titulo de una página remota</title>
    <programlisting role="php">
<![CDATA[
<?php
$file = fopen ("http://www.example.com/", "r");
if (!$file) {
    echo "<p>Imposible abrir el archivo remoto.\n";
    exit;
}
while (!feof ($file)) {
    $line = fgets ($file, 1024);
    /* Esto solo trabaja si el titulo y sus tags estan en una línea */
    if (preg_match ("@\<title\>(.*)\</title\>@i", $line, $out)) {
        $title = $out[1];
        break;
    }
}
fclose($file);
?>
]]>
    </programlisting>
   </example>
  </para>
  <para>
   También se pueden escribir archivos en un servidor FTP (considerando que
   se esta conectado como un usuario con los permisos de acceso correctos).
   Se pueden crear únicamente archivos nuevos usando este método. Si se
   intenta sobreescribir un archivo que ya existe, la llamada a la
   función <function>fopen</function> fallará.
  </para>
  <para>
   Para conectarse como un usuario diferente a 'anonymous', se necesita
   especificar el usuario (y posiblemente el password) con la URL, tal como
   '<literal>ftp://user:password@ftp.example.com/path/to/file</literal>'.
   (Se puede usar la misma sintaxis para accesar archivos vía
   <acronym>HTTP</acronym> cuando se requiere autenticación básica).
  </para>
  <para>
   <example>
    <title>Almacenando datos en un servidor remoto</title>
    <programlisting role="php">
<![CDATA[
<?php
$file = fopen ("ftp://ftp.example.com/incoming/outputfile", "w");
if (!$file) {
    echo "<p>Imposible abrir el archivo remoto para escritura.\n";
    exit;
}
/* Escribir los datos aqui. */
fwrite ($file, $_SERVER['HTTP_USER_AGENT'] . "\n");
fclose ($file);
?>
]]>  
    </programlisting>
   </example>
  </para>
  <para>
   <note>
    <para>
     Se podría tener la idea del ejemplo anterior que se esta usando
     esta técnica para escribir un archivo de log remoto. Desafortunadamente
     esto no funcionaría porque la función <function>fopen</function>
     llamada fallará si el archivo remoto ya existe. Para hacer logs
     distribuidos como ese, se debería dar un vistazo a <function>syslog</function>.
    </para>
   </note>
  </para>

 </chapter>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"~/.phpdoc/manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
