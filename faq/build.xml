<?xml version="1.0" encoding="iso-8859-1"?>
<!-- $Revision: 1.3 $ -->
<!-- EN-Revision: 1.32 Maintainer: lboshell Status: ready -->
<chapter id="faq.build">
  <title>Problemas de Compilaci&oacute;n</title>
  <titleabbrev>Problemas de Compilaci&oacute;n</titleabbrev>

   <para>
    Esta secci&oacute;n re&uacute;ne la mayor&iacute;a de errores que
    ocurren en tiempo de compilaci&oacute;n.
   </para>

  <qandaset>
   <qandaentry id="faq.build.configure">
    <question>
     <para>
      Tengo la &uacute;ltima versi&oacute;n de PHP usando el servicio
      de CVS an&oacute;nimo, &iexcl;pero no hay un script configure!
     </para>
    </question>
    <answer>
     <para>
      Es necesario tener el paquete GNU autoconf instalado de modo que
      pueda generar el script configure desde
      <filename>configure.in</filename>. Simplemente ejecute
      <command>./buildconf</command> en el directorio superior
      despu&eacute;s de obtener las fuentes del servidor
      CVS. (Asimismo, a menos que corra configure con la opci&oacute;n
      <literal>--enable-maintainer-mode</literal>, el script no
      ser&aacute; re-creado autom&aacute;ticamente cuando el archivo
      <filename>configure.in</filename> sea actualizado, as&iacute;
      que debe asegurarse de hacerlo manualmente cuando note que
      configure.in ha cambiado. Un s&iacute;ntoma de esto es encontrar
      cosas como @VARIABLE@ en su Makefile despu&eacute;s de que se
      ejecuta configure o <filename>config.status</filename>.)
     </para>
    </answer>
   </qandaentry>

   <qandaentry id="faq.build.configuring">
    <question>
     <para>
      Tengo problemas configurando PHP para que funcione con
      Apache. Dice que no puede encontrar
      <filename>httpd.h</filename>, &iexcl;pero est&aacute;
      all&iacute; donde dije que estaba!
     </para>
    </question>
    <answer>
     <para>
      Necesita decirle al script configure/setup la ubicaci&oacute;n
      del nivel superior de su &aacute;rbol fuente de Apache. Esto
      quiere decir que debe especificar <option
      role="configure">--with-apache=/ruta/hacia/apache</option> y
      <emphasis>no</emphasis> <option
      role="configure">--with-apache=/ruta/hacia/apache/src</option>.
     </para>
    </answer>
   </qandaentry>

   <qandaentry id="faq.build.lex">
    <question>
     <para>
      Mientras configuraba PHP (<literal>./configure</literal>), se
      encuentra con un error similar al siguiente:
     </para>
     <para>
      <screen>
       checking lex output file root... ./configure: lex: command not
       found configure: error: cannot find output from lex; giving up
      </screen>
     </para>
    </question>
    <answer>
     <para>
      Aseg&uacute;rese de leer las instrucciones de <link
      linkend="install.unix">instalaci&oacute;n</link> cuidadosamente
      y note que necesita instalar tanto flex como bison para compilar
      PHP. Dependiendo de su configuraci&oacute;n, deber&aacute;
      instalar bison y flex ya sea desde el c&oacute;digo fuente, o un
      paquete, como un RPM.
     </para>
    </answer>
   </qandaentry>

   <qandaentry id="faq.build.apache-sharedcore">
    <question>
     <para>
      Cuando intento iniciar Apache, recibo el siguiente mensaje:
     </para>
     <para>
      <screen>
       fatal: relocation error: file /ruta/hacia/libphp4.so: symbol
       ap_block_alarms: referenced symbol not found
      </screen>
     </para>
    </question>
    <answer>
     <para>
      Este error aparece usualmente cuando se compila el programa
      n&uacute;cleo de Apache como una biblioteca DSO para uso
      compartido. Intente reconfigurar apache, asegur&aacute;ndose de
      usar por lo menos las siguientes banderas:
     </para>
     <para>
      <screen>
      --enable-shared=max --enable-rule=SHARED_CORE
      </screen>
     </para>
     <para>
      Para m&aacute;s informaci&oacute;n, lea el archivo
      <filename>INSTALL</filename> en el nivel superior de Apache, o
      la <ulink url="&url.apachedso;">p&aacute;gina del manual
      DSO</ulink> de Apache.
     </para>
    </answer>
   </qandaentry>

   <qandaentry id="faq.build.not-found">
    <question>
     <para>
      Cuando ejecuto configure, &iexcl;dice que no puede encontrar los
      archivos de inclusi&oacute;n o la biblioteca GD, gdbm o
      alg&uacute;n otro paquete!
     </para>
    </question>
    <answer>
     <para>
      Puede hacer que el script configura busque por archivos de
      cabecera y bibliotecas en ubicaciones no-est&aacute;ndar
      especificando banderas a pasar al pre-procesador y enlazador de
      C, como:
      <programlisting>
<![CDATA[
    CPPFLAGS=-I/ruta/hacia/include LDFLAGS=-L/ruta/hacia/biblioteca ./configure
]]>
      </programlisting>
      Si est&aacute; usando una variante de csh como int&eacute;rprete
      de comandos (&iquest;porqu&eacute;?), ser&iacute;a:
      <programlisting>
<![CDATA[
    env CPPFLAGS=-I/ruta/hacia/include LDFLAGS=-L/ruta/hacia/biblioteca ./configure
]]>
      </programlisting>
     </para>
    </answer>
   </qandaentry>

   <qandaentry id="faq.build.yytname">
    <question>
     <para>
      Cuando est&aacute; compilando el archivo
      <filename>language-parser.tab.c</filename>, produce errores
      diciendo <literal>yytname undeclared</literal>.
     </para>
    </question>
    <answer>
     <para>
      Necesita actualizar su versi&oacute;n de Bison. Puede encontrar
      la versi&oacute;n m&aacute;s reciente en <ulink
      url="&url.bison;">&url.bison;</ulink>.
     </para>
    </answer>
   </qandaentry>

   <qandaentry id="faq.build.link">
    <question>
     <para>
      Cuando ejecuto <command>make</command>, parece correr bien pero
      luego falla cuando intenta enlazar la aplicaci&oacute;n final,
      quej&aacute;ndose de que no puede encontrar algunos archivos.
     </para>
    </question>
    <answer>
     <para>
      Algunas versiones antiguas de make no colocan correctamente las
      versiones compiladas de los archivos en el directorio de
      funciones en ese mismo directorio. Intente ejecutar <command>cp
      *.o functions</command> y luego re-ejecute
      <command>make</command> para ver si eso ayuda. Si lo hace,
      realmente deber&iacute;a actualizarse a una versi&oacute;n
      reciente de GNU make.
     </para>
    </answer>
   </qandaentry>

   <qandaentry id="faq.build.undefined">
    <question>
     <para>
      Cuando se enlaza PHP, se queja del n&uacute;mero de referencias
      indefinidas.
     </para>
    </question>
    <answer>
     <para>
      Eche un vistazo a la l&iacute;nea de enlace y aseg&uacute;rese
      de que todas las bibliotecas apropiadas est&aacute;n siendo
      incluidas al final. Algunas comunes que puede estar dejando
      pasar son '-ldl' y cualquier otra biblioteca requerida para el
      soporte de bases de datos que incluy&oacute;.
     </para>
     <para>
      Si est&aacute; enlazando con Apache 1.2.x,
      &iquest;record&oacute; agregar la informaci&oacute;n apropiada a
      la l&iacute;nea EXTRA_LIBS del archivo de configuraci&oacute;n y
      re-ejecut&oacute; el script Configure de Apache? Vea el <link
      linkend="install">cap&iacute;tulo de instalaci&oacute;n</link>
      para m&aacute;s informaci&oacute;n.
     </para>
     <para>
      Algunas personas han reportado tambi&eacute;n que han tenido que
      agregar '-ldl' inmediatamente despu&eacute;s de
      <filename>libphp4.a</filename> cuando enlazan con Apache.
     </para>
    </answer>
   </qandaentry>

   <qandaentry id="faq.build.Apache">
    <question>
     <para>
      No puedo lograr que compile PHP con Apache 1.3.
     </para>
    </question>
    <answer>
     <para>
      En realidad es sencillo. Siga los siguientes pasos
      cuidadosamente:
      <itemizedlist>
       <listitem>
        <simpara>
         Obtenga la &uacute;ltima distribuci&oacute;n de Apache 1.3
         desde <ulink
         url="&url.apache.source;">&url.apache.source;</ulink>.
        </simpara>
       </listitem>
       <listitem>
        <simpara>
         Descomprima el archivo en alguna parte, por ejemplo
         <filename>/usr/local/src/apache-1.3</filename>.
        </simpara>
       </listitem>
       <listitem>
        <simpara>
         Compile PHP ejecutando en un principio <command>./configure
         --with-apache=/&lt;ruta&gt;/apache-1.3</command> (sustituya
         &lt;ruta&gt; con la ruta real a su directorio apache-1.3.)
        </simpara>
       </listitem>
       <listitem>
        <simpara>
         Escriba <command>make</command> seguido de <command>make
         install</command> para compilar PHP y copiar los archivos
         necesarios al &aacute;rbol de la distribuci&oacute;n de
         Apache.
        </simpara>
       </listitem>
       <listitem>
        <simpara>
         Cambie de directorios al directorio
         <filename>/&lt;ruta&gt;/apache-1.3/src</filename> y edite el
         archivo <filename>Configuration</filename>. Agregue al
         archivo: <literal>AddModule modules/php4/libphp4.a</literal>.
        </simpara>
       </listitem>
       <listitem>
        <simpara>
         Escriba: <command>./configure</command> seguido por
         <literal>make</literal>.
        </simpara>
       </listitem>
       <listitem>
        <simpara>
         &iexcl;Ahora debe tener un binario httpd habilitado con PHP!
        </simpara>
       </listitem>
      </itemizedlist>
     </para>
     <para>
      <emphasis>Nota:</emphasis> Tambi&eacute;n es posible usar el
      nuevo script <literal>./configure</literal> de Apache. Vea las
      instrucciones en el archivo <literal>README.configure</literal>
      que es parte de su distribuci&oacute;n de Apache. Tambi&eacute;n
      eche un vistazo al archivo <filename>INSTALL</filename> en la
      distribuci&oacute;n de PHP.
     </para>
    </answer>
   </qandaentry>

   <qandaentry id="faq.build.not-running">
    <question>
     <para>
      He seguido todos los pasos para instalar la versi&oacute;n tipo
      m&oacute;dulo de Apache en Unix, y mis scripts PHP aparecen en
      mi navegador o se me pide que guarde el archivo.
     </para>
    </question>
    <answer>
     <para>
      Esto quiere decir que el m&oacute;dulo PHP no est&aacute; siendo
      invocado por alguna raz&oacute;n. Tres cosas que puede verificar
      antes de solicitar m&aacute;s ayuda:
      <itemizedlist>
       <listitem>
        <simpara>
         Aseg&uacute;rese de que el binario httpd que est&aacute;
         corriendo es el binario httpd real que acaba de
         compilar. Para hacer esto, pruebe ejecutar:
         <literal>/ruta/hacia/binario/httpd -l</literal>
        </simpara>
        <simpara>
         Si no ve <filename>mod_php4.c</filename> listado entonces no
         est&aacute; ejecutando el binario correcto. Encuentre e
         instale el binario correcto.
        </simpara>
       </listitem>
       <listitem>
        <simpara>
         Aseg&uacute;rese de que ha agregado el Tipo Mime correcto a
         uno de sus archivo <literal>.conf</literal> de Apache. Debe
         ser: <literal>AddType application/x-httpd-php3
         .php3</literal> (para PHP 3)
        </simpara>
        <simpara>
         o <literal>AddType application/x-httpd-php .php</literal>
         (para PHP 4)
        </simpara>
        <simpara>
         Tambi&eacute;n aseg&uacute;rese de que esta l&iacute;nea
         AddType no est&aacute; escondida al interior de un bloque
         &lt;Virtualhost&gt; o &lt;Directory&gt; que puede prevenir
         que se aplique en la ubicaci&oacute;n de su script de prueba.
        </simpara>
       </listitem>
       <listitem>
        <simpara>
         Finalmente, la ubicaci&oacute;n predeterminada de los
         archivos de configuraci&oacute;n de Apache cambi&oacute;
         entre Apache 1.2 y Apache 1.3. Deber&iacute;a verificar que
         el archivo de configuraci&oacute;n al que le est&aacute;
         agregando la l&iacute;nea AddType est&aacute; siendo
         le&iacute;do en realidad. Puede colocar un error de sintaxis
         obvio en su archivo &httpd.conf; o alg&uacute;n otro cambio
         obvio que le dir&aacute; si el archivo est&aacute; siendo
         le&iacute;do correctamente.
        </simpara>
       </listitem>
      </itemizedlist>
     </para>
    </answer>
   </qandaentry>

   <qandaentry id="faq.build.activate-module">
    <question>
     <para>
      Dice que use:
      <literal>--activate-module=src/modules/php4/libphp4.a</literal>,
      pero ese archivo no existe, &iexcl;as&iacute; que lo
      cambi&eacute; a
      <literal>--activate-module=src/modules/php4/libmodphp4.a</literal>
      y no funciona! &iquest;Qu&eacute; est&aacute; pasando?
     </para>
    </question>
    <answer>
     <para>
      Note que el archivo <filename>libphp4.a</filename> no se supone
      que exista. !El proceso de apache lo crear&aacute;!
     </para>
    </answer>
   </qandaentry>

   <qandaentry id="faq.build.ansi">
    <question>
     <para>
      Cuando intento compilar Apache con PHP como un m&oacute;dulo
      est&aacute;tico usando
      <literal>--activate-module=src/modules/php4/libphp4.a</literal>
      me dice que mi compilador no es compatible con ANSI.
     </para>
    </question>
    <answer>
     <para>
      Este es un mensaje de error equivocado de Apache que ha sido
      arreglado en versiones m&aacute;s recientes.
     </para>
    </answer>
   </qandaentry>

   <qandaentry id="faq.build.apxs">
    <question>
     <para>
      Cuando intento compilar PHP usando <option
      role="configure">--with-apxs</option> obtengo mensajes de error
      extra&ntilde;os.
     </para>
    </question>
    <answer>
     <para>
      Hay tres cosas que pueden verificarse. Primero, por alguna
      raz&oacute;n cuando Apache compila el script Perl apxs, a veces
      termina compil&aacute;ndose sin las variables y banderas de
      compilaci&oacute;n apropiadas. Encuentre su script apxs (pruebe
      con el comando <command>which apxs</command>), a veces se
      encuentra en <filename>/usr/local/apache/bin/apxs</filename> o
      <filename>/usr/sbin/apxs</filename>. &Aacute;bralo y verifique
      que tenga l&iacute;neas similares a las siguientes:
      <programlisting>
<![CDATA[
my $CFG_CFLAGS_SHLIB  = ' ';          # substituted via Makefile.tmpl
my $CFG_LD_SHLIB      = ' ';          # substituted via Makefile.tmpl
my $CFG_LDFLAGS_SHLIB = ' ';          # substituted via Makefile.tmpl
]]>
      </programlisting>
      Si esto es lo que ve, ha encontrado su problema. Puede que
      contengan solo espacios u otros valores incorrectos, como
      'q()'. Cambie estas l&iacute;neas para que digan:
      <programlisting>
<![CDATA[
my $CFG_CFLAGS_SHLIB  = '-fpic -DSHARED_MODULE'; # substituted via Makefile.tmpl
my $CFG_LD_SHLIB      = 'gcc';                   # substituted via Makefile.tmpl
my $CFG_LDFLAGS_SHLIB = q(-shared);              # substituted via Makefile.tmpl 
]]>
      </programlisting>
      El segundo problema posible deber&iacute;a ocurrir
      &uacute;nicamente en Red Hat 6.1 y 6.2. El script apxs que
      distribuye Red Hat est&aacute; mal. Busque esta l&iacute;nea:
      <programlisting>
<![CDATA[
my $CFG_LIBEXECDIR    = 'modules';         # substituted via APACI install
]]>
      </programlisting>
      Si ve esta l&iacute;nea, c&aacute;mbiela por esto:
      <programlisting>
<![CDATA[
my $CFG_LIBEXECDIR    = '/usr/lib/apache'; # substituted via APACI install
]]>
      </programlisting>
      Por &uacute;ltimo, si usted re-configura/re-instala Apache,
      agregue un <command>make clean</command> al proceso
      despu&eacute;s de <command>./configure</command> y antes de
      <command>make</command>.
     </para>
    </answer>
   </qandaentry>

   <qandaentry id="faq.build.microtime">
    <question>
     <para>
      Durante <command>make</command>, recibo errores sobre microtime,
      y muchos sobre <literal>RUSAGE_</literal>.
    </para>
    </question>
    <answer>
     <para>
      Durante la porci&oacute;n <command>make</command> de la
      instalaci&oacute;n, si encuentra problemas similares a esto:
      <programlisting>
<![CDATA[
microtime.c: In function `php_if_getrusage':
microtime.c:94: storage size of `usg' isn't known
microtime.c:97: `RUSAGE_SELF' undeclared (first use in this function)
microtime.c:97: (Each undeclared identifier is reported only once
microtime.c:97: for each function it appears in.)
microtime.c:103: `RUSAGE_CHILDREN' undeclared (first use in this function)
make[3]: *** [microtime.lo] Error 1
make[3]: Leaving directory `/home/master/php-4.0.1/ext/standard'
make[2]: *** [all-recursive] Error 1
make[2]: Leaving directory `/home/master/php-4.0.1/ext/standard'
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory `/home/master/php-4.0.1/ext'
make: *** [all-recursive] Error 1
]]>
      </programlisting>
     </para>
     <para>
      Su sistema est&aacute; da&ntilde;ado. Necesita arreglar sus
      archivos <filename>/usr/include</filename> instalando un paquete
      glibc-devel que coincida con su glibc. Esto no tiene nada que
      ver con PHP. Para probar este punto, realice la siguiente
      prueba:
     <programlisting>
<![CDATA[
$ cat >test.c <<X
#include <sys/resource.h>
X
$ gcc -E test.c >/dev/null
]]>
      </programlisting>
      Si eso produce errores, sabr&aacute; que sus archivos de
      inclusi&oacute;n est&aacute;n en mal estado.
     </para>
    </answer>
   </qandaentry>

   <qandaentry id="faq.build.mysql.tempnam">
    <question>
     <para>
      Cuando compilo PHP con MySQL, configure corre bien, pero durante
      <literal>make</literal> recibo un error similar al siguiente:
      <emphasis>ext/mysql/libmysql/my_tempnam.o(.text+0x46): In
      function my_tempnam': /php4/ext/mysql/libmysql/my_tempnam.c:103:
      the use of tempnam' is dangerous, better use
      mkstemp'</emphasis>, &iquest;qu&eacute; est&aacute; fallando?
     </para>
    </question>
    <answer>
     <para>
      Primero, es importante entender que esta es una
      <literal>Advertencia</literal> y no un error fatal. Dado que
      &eacute;sta es con frecuencia la &uacute;ltima salida observada
      durante <literal>make</literal>, puede parecer como un error
      fatal, pero no lo es. Por supuesto, si ha configurado su
      compilador para que se detenga en las Advertencias, lo
      har&aacute;. Tambi&eacute;n tenga en cuenta que el soporte MySQL
      est&aacute; habilitado por defecto.
     </para>
     <note>
      <para>
       A partir de PHP 4.3.2, tambi&eacute;n ver&aacute; el siguiente
       texto despu&eacute;s de que la compilaci&oacute;n (make) se
       complete:
      </para>
      <para>
       <screen>
        Build complete.
        (It is safe to ignore warnings about tempnam and tmpnam).
       </screen>
      </para>
     </note>
    </answer>
   </qandaentry>

   <qandaentry id="faq.build.upgrade">
    <question>
     <para>
      Quiero actualizar mi instalaci&oacute;n de
      PHP. &iquest;D&oacute;nde puedo encontrar la l&iacute;nea
      <command>./configure</command> que fue usada para compilar mi
      instalaci&oacute;n actual de PHP?
     </para>
    </question>
    <answer>
     <para>
      Bien puede mirar su archivo config.nice, en el &aacute;rbol
      actual de su instalaci&oacute;n PHP actual o, si no est&aacute;
      disponible, simplemente ejecute un script como el siguiente
      <programlisting role="php">
<![CDATA[
       <?php phpinfo(); ?> 
]]>
      </programlisting>
      Al comienzo de la salida, la l&iacute;nea
      <command>./configure</command> usada para compilar la
      instalaci&oacute;n PHP actual es desplegada.
     </para>
    </answer>
   </qandaentry>

   <qandaentry id="faq.build.gdlibs">
    <question>
     <para>
      Cuando se compila PHP con la biblioteca GD se producen errores
      extra&ntilde;os de compilaci&oacute;n o produce un fallo de
      segmentos (segfault) en la ejecuci&oacute;n.
     </para>
    </question>
    <answer>
     <para>
      Aseg&uacute;rese de que su biblioteca GD y PHP est&aacute;n
      enlazados contra las mismas bibliotecas de dependencia
      (p.ej. libpng).
     </para>
    </answer>
   </qandaentry>

   <qandaentry id="faq.installation.needgnu">
    <question>
     <para>
      Cuando se compila PHP parece que recibo errores aleatorios, como
      si se colgara. Estoy usando Solaris si eso tiene importancia.
     </para>
    </question>
    <answer>
     <para>
      Usar utilidades no-GNU durante la compilaci&oacute;n de PHP
      puede causar problemas. Aseg&uacute;rese de usar herramientas
      GNU para tener la certeza de que la compilaci&oacute;n de PHP
      funcione. Por ejemplo, en Solaris, usar las versiones de SunOS
      compatibles-con-BSD o de Solaris de <literal>sed</literal> no
      funcionar&aacute;, pero usar las versiones GNU o Sun POSIX
      (xpg4) de <literal>sed</literal> lo har&aacute;. Enlaces: <ulink
      url="&url.sed;">GNU sed</ulink>, <ulink url="&url.flex;">GNU
      flex</ulink>, y <ulink url="&url.bison;">GNU bison</ulink>.
     </para>
    </answer>
   </qandaentry>
  </qandaset>
 </chapter>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"../../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
