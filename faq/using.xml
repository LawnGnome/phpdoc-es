<?xml version="1.0" encoding="iso-8859-1"?>
<!-- $Revision: 1.5 $ -->
<!-- EN-Revision: 1.33 Maintainer: lboshell Status: ready -->
<chapter id="faq.using">
  <title>Uso de PHP</title>
  <titleabbrev>Uso de PHP</titleabbrev>

  <para>
   Esta secci&oacute;n re&uacute;ne varios errores comunes que usted
   puede enfrentar cuando escribe scripts PHP.
  </para>

  <qandaset>
   <qandaentry id="faq.using.anyform">
    <question>
     <para>
      Quisiera escribir un script PHP gen&eacute;rico que pudiera
      manejar datos que lleguen desde cualquier
      formulario. &iquest;C&oacute;mo averiguo qu&eacute; variables
      del m&eacute;todo POST se encuentran disponibles?
     </para>
    </question>
    <answer>
     <para>
      PHP ofrece numerosas <link linkend="language.variables.predefined">
      variables predefinidas</link>, como la super-global <varname>
      $_POST</varname>. Usted podr&iacute;a
      recorrer <varname>$_POST</varname> con un ciclo ya que se trata
      de una matriz asociativa con todos los valores POST. Por
      ejemplo, puede recorrer la matriz simplemente con <link
      linkend="control-structures.foreach">foreach</link>, realizar un
      chequeo por valores <function>empty</function>, e imprimirlos.
      <programlisting role="php">
<![CDATA[
<?php
$vacio = $post = array();
foreach ($_POST as $nombre_var => $valor_var) {
    if (empty($valor_var)) {
        $vacio[$nombre_var] = $valor_var;
    } else {
        $post[$nombre_var] = $valor_var;
    }
}

print "<pre>";
if (empty($vacio)) {
    print "Ninguno de los valores POST est&aacute;n vac&iacute;os, se envi&oacute;:\n";
    var_dump($post);
} else {
    print "Tenemos " . count($vacio) . " valores vac&iacute;os\n";
    print "Se envi&oacute;:\n"; var_dump($post);
    print "Vac&iacute;os:\n";  var_dump($vacio);
    exit;
}
?>
]]>
      </programlisting>
     </para>
     
     &note.superglobals;

    </answer>
   </qandaentry>

   <qandaentry id="faq.using.addslashes">
    <question>
     <para>
      Necesito convertir todas las comillas sencillas (') en una barra
      invertida seguida de una comilla sencilla
      (\'). &iquest;C&oacute;mo puedo hacer esto con una
      expresi&oacute;n regular? Tambi&eacute;n me gustar&iacute;a
      convertir " en \" y \ en \\.
     </para>
    </question>
    <answer>
     <para>
      La funci&oacute;n <function>addslashes</function> hace esto. Vea
      tambi&eacute;n <function>mysql_escape_string</function>. Tambi&eacute;n
      puede remover las barras invertidas
      con <function>stripslashes</function>.
     </para>

     &note.magicquotes.gpc;

    </answer>
   </qandaentry>
   
   <qandaentry id="faq.using.stripslashes">
    <question>
     <para>
      Todos mis caracteres " se convierten en \" y mis ' se convierten
      en \', &iquest;c&oacute;mo me deshago de todas esas barras
      invertidas indeseadas? &iquest;C&oacute;mo y porqu&eacute;
      llegaron all&iacute;?
     </para>
    </question>
    <answer>
     <para>
      La funci&oacute;n de PHP <function>stripslashes</function>
      eliminar&aacute; todas esas barras invertidas de su
      variable <type>string</type>. Lo m&aacute;s posible es que esas
      barras invertidas existen m&aacute;gicamente por que la
      directiva de PHP
      <link linkend="ini.magic-quotes-gpc">magic_quotes_gpc</link>
      est&aacute; activa.
     </para>
     
     &note.magicquotes.gpc;
     
    </answer>
   </qandaentry>   

   <qandaentry id="faq.using.wrong-order">
    <question>
     <para>
      Cuando hago lo siguiente, la salida se imprime en el orden
      equivocado:
     <programlisting role="php">
<![CDATA[
<?php
function mi_funcion($argumento)
{
    echo $argumento + 10;
}
$variable = 10;
echo "mi_funcion($variable) = " . mi_funcion($variable);
?>
]]>
    </programlisting>
      &iquest;qu&eacute; sucede?
     </para>
    </question>
    <answer>
     <para>
      Para poder usar los resultados de su funci&oacute;n en una
      expresi&oacute;n (como ocurre al concatenar con otras cadenas,
      como en el ejemplo anterior), necesita devolver el valor
      mediante <function>return</function>, no imprimirlo
      con <function>echo</function>.
     </para>
    </answer>
   </qandaentry>

   <qandaentry id="faq.using.newlines">
    <question>
     <para>
      &iquest;Hey, qu&eacute; ha sucedido con mis saltos de
      l&iacute;nea?
      <programlisting role="php">
<![CDATA[
<pre>
<?php echo "Esta debe ser la primera l&iacute;nea."; ?>
<?php echo "Esto debe aparecer despu&eacute;s de la nueva l&iacute;nea anterior."; ?>
</pre>
]]>
      </programlisting>
     </para>
    </question>
    <answer>
     <para>
      En PHP, el final de un bloque de c&oacute;digo es, o bien
      "?&gt;" o "?&gt;\n" (en donde \n quiere decir una nueva
      l&iacute;nea). De modo que en el ejemplo anterior, las
      sentencias impresas con echo estar&aacute;n en una l&iacute;nea,
      puesto que PHP omite los saltos de l&iacute;nea despu&eacute;s
      del final del bloque. Esto quiere decir que usted necesita
      insertar un salto de l&iacute;nea extra despu&eacute;s de cada
      bloque de c&oacute;digo PHP para hacer que imprima una nueva
      l&iacute;nea.
     </para>
     <para>
      &iquest;Porqu&eacute; hace esto PHP? Por que al dar formato a un
      documento HTML normal, este comportamiento por lo general hace
      su vida m&aacute;s simple, ya que no desea ese salto de
      l&iacute;nea, pero tendr&iacute;a que crear l&iacute;neas
      extremadamente largas o de otra forma hacer ilegible el
      c&oacute;digo fuente base para lograr ese efecto.
     </para>
    </answer>
   </qandaentry>

   <qandaentry id="faq.using.headers-sent">
    <question>
     <para>
      Recibo el mensaje 'Warning: Cannot send session cookie - headers
      already sent...' o 'Cannot add header information - headers
      already sent...'.
     </para>
    </question>
    <answer>
     <para>
      Las
      funciones <function>header</function>, <function>setcookie</function>,
      y las <link linkend="ref.session">funciones de
      sesi&oacute;n</link> necesitan agregar cabeceras a la secuencia
      de salida, pero las cabeceras s&oacute;lo pueden ser enviadas
      antes del resto del contenido. No puede haber salida antes de
      usar &eacute;stas funciones, salida como HTML. La
      funci&oacute;n <function>headers_sent</function> revisa si su
      script ya ha enviado las cabeceras, y asimismo consulte
      las <link linkend="ref.outcontrol">funciones de Control de
      Salida</link>.
     </para>
    </answer>
   </qandaentry>

   <qandaentry id="faq.using.header">
    <question>
     <para>
      Necesito acceder a informaci&oacute;n directamente de las
      cabeceras de la petici&oacute;n. &iquest;C&oacute;mo puedo hacer
      esto?
     </para>
    </question>
    <answer>
     <para>
      La funci&oacute;n <function>getallheaders</function> har&aacute;
      esto si est&aacute; ejecutando PHP como m&oacute;dulo de
      Apache. As&iacute; que, el siguiente segmento de c&oacute;digo
      le mostrar&aacute; todas las cabeceras de petici&oacute;n:
      <programlisting role="php">
<![CDATA[
<?php
$cabeceras = getallheaders();
foreach ($cabeceras as $nombre => $contenido) {
    echo "cabeceras[$nombre] = $contenido<br />\n";
}
?>
]]>
      </programlisting>
     </para>
     <para>
      Vea tambi&eacute;n
      <function>apache_lookup_uri</function>,
      <function>apache_response_headers</function>, y
      <function>fsockopen</function>
     </para>
    </answer>
   </qandaentry>

   <qandaentry id="faq.using.authentication">
    <question>
     <para>
      Cuando intento usar autenticaci&oacute;n con IIS, recibo el
      mensaje 'No Input file specified'.
     </para>
    </question>
    <answer>
     <para>
      El modelo de seguridad de IIS es la causa del problema
      aqu&iacute;. Este es un inconveniente com&uacute;n a todos los
      programas CGI que corren bajo IIS. Una forma de evitar el
      problema es crear un archivo HTML plano (no interpretado por
      PHP) como p&aacute;gina de entrada en un directorio
      autenticado. Luego usar una etiqueta META para redirigir a la
      p&aacute;gina PHP, o tener un enlace hacia la p&aacute;gina
      PHP. PHP reconocer&aacute; entonces la autenticaci&oacute;n
      correctamente. Con el m&oacute;dulo ISAPI, esto no es un
      problema. Este inconveniente no debe afectar otros servidores
      web NT. Para m&aacute;s informaci&oacute;n, vea:
      <ulink url="&url.iis;">&url.iis;</ulink> y la secci&oacute;n del manual
      sobre <link linkend="features.http-auth">Autenticaci&oacute;n
      HTTP</link>.
     </para>
    </answer>
   </qandaentry>

   <qandaentry id="faq.using.iis.sharing">
    <question>
     <para>
      Windows: No puedo acceder a archivos compartidos en otra
      computadora usando IIS
     </para>
    </question>
    <answer>
     <para>
      Necesita modificar el valor <literal>Go to Internet Information
      Services</literal>. Ubique su archivo PHP y dir&iacute;jase a
      sus propiedades. Vaya a la pesta&ntilde;a <literal>Seguridad de
      Archivo</literal>, <literal>Editar -&lt; Acceso an&oacute;nimo y
      control de autenticaci&oacute;n</literal>.
     </para>
     <para>
      Puede solucionar el problema ya sea deshabilitando
      <literal>Acceso An&oacute;nimo</literal> y dejando habilitado
      <literal>Autenticaci&oacute;n Integrada</literal>, o habilitando
      <literal>Acceso An&oacute;nimo</literal> y editando el usuario
      ya que &eacute;ste puede no tener el acceso bien definido.
     </para>
    </answer>
   </qandaentry>

   <qandaentry id="faq.using.netscape">
    <question>
     <para>
      Mi script PHP funciona en IE y Lynx, pero en Netscape parte de
      mi salida est&aacute; faltando. Cuando acciono "Ver
      c&oacute;digo fuente" veo el contenido en IE pero no en
      Netscape.
     </para>
    </question>
    <answer>
     <para>
      Netscape es m&aacute;s estricto que IE en cuanto a etiquetas
      HTML (como tablas) se refiere. Pasar su salida HTML a
      trav&eacute;s de un validador de HTML, como <ulink
      url="&url.w3.validator;">validator.w3.org</ulink>, puede ser de
      ayuda. Por ejemplo, una etiqueta &lt;/table&gt; faltante puede
      ser la causa de &eacute;ste problema.
     </para>
     <para>
      Asimismo, tanto IE como Lynx ignoran los caracteres NUL
      (<literal>\0</literal>) en la secuencia HTML, mientras que
      Netscape no. La mejor manera de chequear esto es compilar la
      versi&oacute;n de <link
      linkend="features.commandline">l&iacute;nea de comandos</link>
      de PHP (tambi&eacute;n conocida como la versi&oacute;n CGI) y
      ejecutar su script desde la l&iacute;nea de comandos. En *nix,
      env&iacute;e la salida a trav&eacute;s de un pipe a <literal>od
      -c</literal> y busque caracteres <literal>\0</literal>. Si se
      encuentra en Windows necesita un editor o alg&uacute;n otro
      programa que le permita ver archivos binarios. Cuando Netscape
      ve un NUL en un archivo, t&iacute;picamente no imprimir&aacute;
      nada m&aacute;s en aquella l&iacute;nea, mientras que tanto IE
      como Lynx si lo hacen.
     </para>
    </answer>
   </qandaentry>

   <qandaentry id="faq.using.mixml">
    <question>
     <para>
      &iquest;C&oacute;mo se supone que mezcle XML y PHP? &iexcl;Se
      queja sobre mis etiquetas &lt;?xml!
     </para>
    </question>
    <answer>
     <para>
      Para poder embeber etiquetas &lt;?xml directamente en su
      c&oacute;digo PHP, tendr&aacute; que deshabilitar las etiquetas
      cortas, definiendo la directiva PHP <link
      linkend="ini.short-open-tag">short_open_tags</link>
      como <literal>0</literal>. No puede definir esta directiva
      con <function>ini_set</function>. Independientemente del valor
      de <link linkend="ini.short-open-tag">short_open_tags</link>,
      usted puede hacer algo como:
      <literal>&lt;?php echo '&lt;?xml'; ?&gt;</literal>. El valor
      predeterminado para esta directiva es on.
     </para>
    </answer>
   </qandaentry>

   <qandaentry id="faq.using.editor">
    <question>
     <para>
      &iquest;C&oacute;mo puedo usar PHP con FrontPage u otro editor
      HTML que insiste en mover mi c&oacute;digo por todas partes?
     </para>
    </question>
    <answer>
     <para>
      Una de las cosas m&aacute;s f&aacute;ciles es habilitar el uso
      de etiquetas ASP en su c&oacute;digo PHP. Esto le permite usar
      el estilo de delimitadores de c&oacute;digo ASP &lt;% y
      %&gt;. Algunos de los editores HTML populares gestionan
      &eacute;stas etiquetas de forma m&aacute;s inteligente (por
      ahora). Para habilitar las etiquetas estilo-ASP, necesita
      definir la variable &php.ini; <link
      linkend="ini.asp-tags">asp_tags</link>, o usar la directiva de
      Apache apropiada.
     </para>
    </answer>
   </qandaentry>

   <qandaentry id="faq.using.variables">
    <question>
     <para>
      &iquest;En d&oacute;nde puedo encontrar una lista completa de
      variables disponibles en PHP?
     </para>
    </question>
    <answer>
     <para>
      Consulte la p&aacute;gina del manual sobre <link
      linkend="language.variables.predefined">variables
      predefinidas</link>, ya que all&iacute; se incluye una lista
      parcial de variables predefinidas disponibles para su
      script. Una lista completa de variables disponibles (y mucha
      m&aacute;s informaci&oacute;n) puede ser consultada al llamar la
      funci&oacute;n
      <function>phpinfo</function>. Aseg&uacute;rese de leer la
      secci&oacute;n del manual sobre <link
      linkend="language.variables.external">variables externas a
      PHP</link> ya que all&iacute; se describen escenarios comunes
      para variables externas, como las provenientes de formularios
      HTML, Cookies y URLs.
     </para>
     
     &note.registerglobals;

    </answer>
   </qandaentry>

   <qandaentry id="faq.using.freepdf">
    <question>
     <para>
      &iquest;C&oacute;mo puedo generar archivos PDF sin usar las
      bibliotecas no-libres y comerciales <link
      linkend="ref.cpdf">ClibPDF</link> y <link
      linkend="ref.pdf">PDFLib</link>? Quisiera algo que fuera
      gratuito y no requiera de bibliotecas PDF externas.
     </para>
    </question>
    <answer>
     <para>
      Existen algunas pocas alternativas escritas en PHP, como
      <ulink url="&url.pdf.ros;">&url.pdf.ros;</ulink>,
      <ulink url="&url.pdf.fpdf;">&url.pdf.fpdf;</ulink>,
      <ulink url="&url.pdf.pdf4php;">&url.pdf.pdf4php;</ulink>, y
      <ulink
      url="&url.pdf.phppdflib;">&url.pdf.phppdflib;</ulink>. Tambi&eacute;n
      existe el m&oacute;dulo <ulink
      url="&url.pdf.panda;">Panda</ulink>.
     </para>
    </answer>
   </qandaentry>

   <qandaentry id="faq.using.cgi-vars">
    <question>
     <para>
      Estoy tratando de acceder a una de las variables CGI
      est&aacute;ndar (como $DOCUMENT_ROOT o $HTTP_REFERER) en una
      funci&oacute;n definida por el usuario, y parece que no la
      encuentra. &iquest;Qu&eacute; est&aacute; fallando?
     </para>
    </question>
    <answer>
     <para>
      Es importante darse cuenta de que la directiva PHP <link
      linkend="ini.register-globals">register_globals</link>
      tambi&eacute;n afecta a variables de servidor y de
      entorno. Cuando register_globals = off (el valor predeterminado
      es off a partir de PHP 4.2.0), <varname>$DOCUMENT_ROOT</varname>
      no existir&aacute;. En su lugar, use
      <varname>$_SERVER['DOCUMENT_ROOT']</varname>. Si
      register_globals = on entonces las variables
      <varname>$DOCUMENT_ROOT</varname> y
      <varname>$GLOBALS['DOCUMENT_ROOT']</varname> existir&aacute;n
      tambi&eacute;n.
     </para>
     <para>
      Si est&aacute; seguro de que register_globals = on y se pregunta
      porqu&eacute; <varname>$DOCUMENT_ROOT</varname> no se encuentra
      disponible al interior de funciones, es porque &eacute;ste tipo
      de variables es como cualquier otra, y requerir&iacute;a de una
      sentencia <literal>global $DOCUMENT_ROOT</literal> al interior
      de la funci&oacute;n. Vea tambi&eacute;n la p&aacute;gina del
      manual sobre los
      <link linkend="language.variables.scope">contextos de
      variables</link>. Es recomendable escribir c&oacute;digo bajo el
      modelo register_globals = off.
     </para>

     &note.superglobals;

    </answer>
   </qandaentry>

   <qandaentry id="faq.using.shorthandbytes">
    <question>
     <para>
      Algunas directivas de PHP pueden recibir tambi&eacute;n atajos
      de valores de bytes, en lugar de recibir s&oacute;lamente
      valores de bytes tipo
      <type>integer</type>. &iquest;Cu&aacute;les son todas las
      opciones de atajos de valores de byte disponibles?  &iquest;Y
      puedo usarlos por fuera de &php.ini;?
     </para>
    </question>
    <answer>
     <para>
      Las opciones disponibles son K (para Kilobytes), M (para
      Megabytes) y G (para Gigabytes; disponible desde PHP 5.1.0), las
      cuales son insensibles a may&uacute;sculas y
      min&uacute;sculas. Cualquier otro valor asume
      bytes. <literal>1M</literal> es igual a un Megabyte o
      <literal>1048576</literal> bytes. <literal>1K</literal> es igual
      a un Kilobyte o <literal>1024</literal> bytes. No deber&iacute;a
      usar &eacute;stas notaciones cortas por fuera de &php.ini;, en
      su lugar use un valor <type>integer</type> de bytes. Vea la
      documentaci&oacute;n de <function>ini_get</function> para un
      ejemplo sobre c&oacute;mo convertir tales valores.
     </para>
    </answer>
   </qandaentry>

  </qandaset>
 </chapter>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"../../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
