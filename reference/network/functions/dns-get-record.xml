<?xml version="1.0" encoding="iso-8859-1"?>
<!-- $Revision: 1.6 $ -->
<!-- EN-Revision: 1.21 Maintainer: lboshell Status: ready -->
  <refentry xml:id="function.dns-get-record" xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">
    <refnamediv>
     <refname>dns_get_record</refname>
     <refpurpose>
      Recuperar Registros de Recursos DNS asociados con un nombre de
      servidor hu&eacute;sped
     </refpurpose>
    </refnamediv>
    <refsect1>
     <title>Descripci&oacute;n</title>
      <methodsynopsis>
       <type>array</type><methodname>dns_get_record</methodname>
       <methodparam><type>string</type><parameter>nombre_host</parameter></methodparam>
       <methodparam choice="opt"><type>int</type><parameter>tipo</parameter></methodparam>
       <methodparam choice="opt"><type>array</type><parameter role="reference">authns</parameter></methodparam>
       <methodparam><type>array</type><parameter role="reference">addtl</parameter></methodparam>
      </methodsynopsis>
     <para>
      <note>
       <simpara>
        Esta funci&oacute;n no est&aacute; implementada en plataformas
        Windows, ni funciona (actualmente) en systemas *BSD. Pruebe
        con la clase <link xlink:href="&url.php.pear;">PEAR</link> <link
        xlink:href="&url.pear.package;Net_DNS">Net_DNS</link>.
       </simpara>
      </note>
     </para>
     <para>
      Esta funci&oacute;n devuelve una matriz de matrices
      asociativas. Cada matriz asociativa contiene <emphasis>por lo
      menos</emphasis> las siguientes claves:
      <table>
       <title>Atributos DNS b&aacute;sicos</title>
       <tgroup cols="2">
        <thead>
         <row>
          <entry>Atributo</entry>
          <entry>Significado</entry>
         </row>
        </thead>
        <tbody>
         <row>
          <entry>host</entry>
          <entry>
           El registro en el espacio de nombres DNS al que hacen
           referencia el resto de datos asociados.
          </entry>
         </row>
         <row>
          <entry>class</entry>
          <entry>
           <function>dns_get_record</function> devuelve
           &uacute;nicamente registros de clase Internet y como tal,
           &eacute;ste par&aacute;metro siempre
           devolver&aacute; <literal>IN</literal>.
          </entry>
         </row>
         <row>
          <entry>type</entry>
          <entry>
           Cadena que contiene el tipo de registro. Otros atributos
           adicionales ser&aacute;n contenidos tambi&eacute;n en la
           matriz resultante dependiendo del valor de type. Vea la
           tabla m&aacute;s adelante.
          </entry>
         </row>
         <row>
          <entry>ttl</entry>
          <entry>
           Valor Time To Live restante para este
           registro. Este <emphasis>no</emphasis> ser&aacute; igual al
           ttl original del registro, sino que ser&aacute; igual al
           ttl original menos cualquiera que haya sido la longitud de
           tiempo transcurrido desde que el servidor de nombres
           oficial fuera consultado.
          </entry>
         </row>
        </tbody>
       </tgroup>
      </table>
     </para>
     <simpara>
      <parameter>nombre_host</parameter> debe ser un nombre de
      servidor hu&eacute;sped DNS v&aacute;lido, como
      "www.example.com". Pueden generarse consultas revertidas usando
      la notaci&oacute;n in-addr.arpa, pero
      <function>gethostbyaddr</function> es m&aacute;s apropiada para
      la mayor&iacute;a de consultas revertidas.
     </simpara>
     <para>
      Por defecto, <function>dns_get_record</function> buscar&aacute;
      por cualquier registro de recurso asociado con
      <parameter>nombre_host</parameter>. Para limitar la consulta,
      especifique el par&aacute;metro opcional
      <parameter>tipo</parameter>. <parameter>tipo</parameter> puede
      ser cualquiera de los siguientes: <constant>DNS_A</constant>,
      <constant>DNS_CNAME</constant>, <constant>DNS_HINFO</constant>,
      <constant>DNS_MX</constant>, <constant>DNS_NS</constant>,
      <constant>DNS_PTR</constant>, <constant>DNS_SOA</constant>,
      <constant>DNS_TXT</constant>, <constant>DNS_AAAA</constant>,
      <constant>DNS_SRV</constant>, <constant>DNS_NAPTR</constant>,
      <constant>DNS_A6</constant>, <constant>DNS_ALL</constant> o
      <constant>DNS_ANY</constant>. El valor predeterminado es
      <emphasis>DNS_ANY</emphasis>.
      <note>
       <para>
        Debido a excentricidades en el rendimiento de libresolv entre
        plataformas, <constant>DNS_ANY</constant> no siempre
        devolver&aacute; todos los registros, la alternativa
        m&aacute;s lenta <constant>DNS_ALL</constant>
        recolectar&aacute; todos los registros de forma m&aacute;s
        confiable.
       </para>
      </note>
     </para>
     <simpara>
      Los opcionales tercer y cuarto argumento de esta funci&oacute;n,
      <parameter>authns</parameter> y <parameter>addtl</parameter> son
      pasados por referencia y, si son usados, ser&aacute;n llenados
      con Registros de Recurso para los <emphasis>Servidores de
      Nombres Oficiales</emphasis>, y cualquier <emphasis>Registro
      Adicional</emphasis> respectivamente. Vea el ejemplo m&aacute;s
      adelante.
     </simpara>
     <para>
      <table>
       <title>Otras claves en las matrices asociativas, dependientes
       de 'type'</title>
       <tgroup cols="2">
        <thead>
         <row>
          <entry>Tipo</entry>
          <entry>Columnas Extra</entry>
         </row>
        </thead>
        <tbody>
         <row>
          <entry><literal>A</literal></entry>
          <entry>
           <literal>ip</literal>: Una direcci&oacute;n IPv4 en
           notaci&oacute;n decimal con puntos.
          </entry>
         </row>
         <row>
          <entry><literal>MX</literal></entry>
          <entry>
           <literal>pri</literal>: Prioridad del gestor de
           correo. N&uacute;meros b&aacute;s bajos indican mayor
           prioridad.
           <literal>target</literal>: FQDN del gestor de correo. Vea
           tambi&eacute;n <function>dns_get_mx</function>.
          </entry>
         </row>
         <row>
          <entry><literal>CNAME</literal></entry>
          <entry>
           <literal>target</literal>: FQDN de la ubicaci&oacute;n en
           el espacio de nombres DNS de la cual es alias el registro.
          </entry>
         </row>
         <row>
          <entry><literal>NS</literal></entry>
          <entry>
           <literal>target</literal>: FQDN del servidor de nombres que
           es la autoridad para este nombre de host.
          </entry>
         </row>
         <row>
          <entry><literal>PTR</literal></entry>
          <entry>
           <literal>target</literal>: Ubicaci&oacute;n dentro del
           espacio de nombres DNS a la que apunta este registro.
          </entry>
         </row>
          <row>
          <entry><literal>TXT</literal></entry>
          <entry>
           <literal>txt</literal>: Cadena de datos arbitraria asociada
           con este registro.
          </entry>
         </row>
         <row>
          <entry><literal>HINFO</literal></entry>
          <entry>
           <literal>cpu</literal>: N&uacute;mero IANA que indica el
           CPU de la m&aacute;quina referenciada por este registro.
           <literal>os</literal>: N&uacute;mero IANA que indica el
           Sistema Operativo en la m&aacute;quina referenciada por
           este registro.  Vea los <link
           xlink:href="&url.iana.system-names;">Nombres de Sistemas
           Operativos</link> de IANA para consultar el significado de
           estos valores.
          </entry>
         </row>
         <row>
          <entry><literal>SOA</literal></entry>
          <entry>
           <literal>mname</literal>: FQDN de la m&aacute;quina desde
           donde se originaron los registros de recurso.
           <literal>rname</literal>: Direcci&oacute;n de correo
           electr&oacute;nico del contacto administrativo para este
           dominio.
           <literal>serial</literal>: # serial de esta revisi&oacute;n
           del dominio solicitado.
           <literal>refresh</literal>: Intervalo de
           actualizaci&oacute;n (segundos) que deben usar los
           servidores de nombre secundarios cuando actualicen las
           copias remotas de este dominio.
           <literal>retry</literal>: Periodo de tiempo (segundos) para
           esperar despu&eacute;s de una actualizaci&oacute;n fallida
           antes de hacer un segundo intento.
           <literal>expire</literal>: Periodo m&aacute;ximo de tiempo
           (segundos) que un servidor DNS secundario debe conservar
           copias remotas de los datos de zona sin una
           actualizaci&oacute;n exitosa antes de descartarlos.
           <literal>minimum-ttl</literal>: Periodo m&iacute;nimo de
           tiempo (segundos) en el que un cliente puede continuar
           usando una resoluci&oacute;n DNS antes de que deba
           solicitar una nueva resoluci&oacute;n del servidor. Puede
           ser sobrescrito por registros de recurso individuales.
          </entry>
         </row>
         <row>
          <entry><literal>AAAA</literal></entry>
          <entry>
           <literal>ipv6</literal>: Direcci&oacute;n IPv6
          </entry>
         </row>
         <row>
          <entry><literal>A6</literal>(PHP &gt;= 5.1.0)</entry>
          <entry>
           <literal>masklen</literal>: Longitud (en bits) para heredar
           del destino especificado por <parameter>chain</parameter>.
           <literal>ipv6</literal>: Direcci&oacute;n para mezclar este
           registro espec&iacute;fico con
           <parameter>chain</parameter>.  <literal>chain</literal>:
           Registro padre a mezclar con los datos de
           <parameter>ipv6</parameter>.
          </entry>
         </row>
         <row>
          <entry><literal>SRV</literal></entry>
          <entry>
           <literal>pri</literal>: (Prioridad) las prioridades
           m&aacute;s bajas deben ser usadas primero.
           <literal>weight</literal>: Rangos para pesar cu&aacute;l de
           los <parameter>destinos</parameter> comunmente con
           prioridades debe ser elegido al azar.
           <literal>target</literal> y <literal>port</literal>: nombre
           de servidor hu&eacute;sped y puerto en dondo puede
           encontrarse el servicio solicitado. Para m&aacute;s
           informaci&oacute;n, vea: <link xlink:href="&url.rfc;2782">RFC
           2782</link>
          </entry>
         </row>
         <row>
          <entry><literal>NAPTR</literal></entry>
          <entry>
           <literal>order</literal> y <literal>pref</literal>: Equivalente a
           <parameter>pri</parameter> y <parameter>weight</parameter>
           descritos anteriormente.
           <literal>flags</literal>, <literal>services</literal>,
           <literal>regex</literal>, y <literal>replacement</literal>:
           Par&aacute;metros, como se definen por <link
           xlink:href="&url.rfc;2915">RFC 2915</link>.
          </entry>
         </row>
        </tbody>
       </tgroup>
      </table>
     </para>
     <para>
      <note>
       <para>
        Debido a est&aacute;ndares DNS, las direcciones de correo
        electr&oacute;nico son dadas en formato usuario.host (por
        ejemplo: hostmaster.example.com en lugar de
        hostmaster@example.com), aseg&uacute;rese de chequear este
        valor y modificarlo si es necesario antes de usarlo con
        funciones como <function>mail</function>.
       </para>
      </note>
     </para>
     <example>
      <title>Uso de <function>dns_get_record</function></title>
      <programlisting role="php">
<![CDATA[
<?php
$resultado = dns_get_record("php.net");
print_r($resultado);
?>
]]>
      </programlisting>
      <para>
       Produce una salida similar a la siguiente:
      </para>
      <screen>
<![CDATA[
Array
(
    [0] => Array
        (
            [host] => php.net
            [type] => MX
            [pri] => 5
            [target] => pair2.php.net
            [class] => IN
            [ttl] => 6765
        )

    [1] => Array
        (
            [host] => php.net
            [type] => A
            [ip] => 64.246.30.37
            [class] => IN
            [ttl] => 8125
        )

)
]]>
      </screen>
     </example>
     <simpara>
      Ya que es muy com&uacute;n desear la direcci&oacute;n IP de un
      servidor de correo una vez el registro MX ha sido resuelto,
      <function>dns_get_record</function> tambi&eacute;n devuelve una
      matriz en <parameter>addtl</parameter> la cual contiene
      registros asociados. <parameter>authns</parameter> es devuelto
      tambi&eacute;n, conteniendo una lista de servidores de nombre
      oficiales.
     </simpara>
     <example>
      <title>Uso de  <function>dns_get_record</function> y
      DNS_ANY</title>
      <programlisting role="php">
<![CDATA[
<?php

/* Solicitar "cualquier" registro para php.net, y crear las matrices
   $authns y $addtl conteniendo una lista de servidores de nombre y
   cualquier registro adicional que vaya con ellos */

$resultado = dns_get_record("php.net", DNS_ANY, $authns, $addtl);
echo "Resultado = ";
print_r($resultado);
echo "Auth NS = ";
print_r($authns);
echo "Adicional = ";
print_r($addtl);
?>
]]>
      </programlisting>
      <para>
       Produce una salida similar a la siguiente:
      </para>
      <screen>
<![CDATA[
Result = Array
(
    [0] => Array
        (
            [host] => php.net
            [type] => MX
            [pri] => 5
            [target] => pair2.php.net
            [class] => IN
            [ttl] => 6765
        )

    [1] => Array
        (
            [host] => php.net
            [type] => A
            [ip] => 64.246.30.37
            [class] => IN
            [ttl] => 8125
        )

)
Auth NS = Array
(
    [0] => Array
        (
            [host] => php.net
            [type] => NS
            [target] => remote1.easydns.com
            [class] => IN
            [ttl] => 10722
        )

    [1] => Array
        (
            [host] => php.net
            [type] => NS
            [target] => remote2.easydns.com
            [class] => IN
            [ttl] => 10722
        )

    [2] => Array
        (
            [host] => php.net
            [type] => NS
            [target] => ns1.easydns.com
            [class] => IN
            [ttl] => 10722
        )

    [3] => Array
        (
            [host] => php.net
            [type] => NS
            [target] => ns2.easydns.com
            [class] => IN
            [ttl] => 10722
        )

)
Additional = Array
(
    [0] => Array
        (
            [host] => pair2.php.net
            [type] => A
            [ip] => 216.92.131.5
            [class] => IN
            [ttl] => 6766
        )

    [1] => Array
        (
            [host] => remote1.easydns.com
            [type] => A
            [ip] => 64.39.29.212
            [class] => IN
            [ttl] => 100384
        )

    [2] => Array
        (
            [host] => remote2.easydns.com
            [type] => A
            [ip] => 212.100.224.80
            [class] => IN
            [ttl] => 81241
        )

    [3] => Array
        (
            [host] => ns1.easydns.com
            [type] => A
            [ip] => 216.220.40.243
            [class] => IN
            [ttl] => 81241
        )

    [4] => Array
        (
            [host] => ns2.easydns.com
            [type] => A
            [ip] => 216.220.40.244
            [class] => IN
            [ttl] => 81241
        )

)
]]>
      </screen>
     </example>
     <simpara>
      Vea tambi&eacute;n <function>dns_get_mx</function>, y
      <function>dns_check_record</function>
     </simpara>
    </refsect1>
  </refentry>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"../../../../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
