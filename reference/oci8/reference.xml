<?xml version="1.0" encoding="iso-8859-1"?>
<!-- $Revision: 1.4 $ -->
<!-- EN-Revision: 1.13 Maintainer: lboshell Status: ready -->
 <reference id="ref.oci8">
  <title>Funciones de Oracle 8</title>
  <titleabbrev>OCI8</titleabbrev>

  <partintro>
   <section id="oci8.intro">
    &reftitle.intro;
    <para>
     Estas funciones le permiten acceder a bases de datos Oracle9,
     Oracle8 y Oracle7. Usan la Interfaz de Llamadas Oracle (OCI por
     sus siglas en Ingl&eacute;s).
    </para>
    <para>
     Esta extensi&oacute;n es m&aacute;s flexible que la
     extensi&oacute;n <link linkend="ref.oracle">antigua de
     Oracle</link>. &Eacute;sta soporta la vinculaci&oacute;n de
     variables PHP globales y locales con recipientes Oracle, tiene
     soporte completo LOB, FILE y ROWID, y le permite usar variables
     de definici&oacute;n entregadas por el usuario. Es recomendable
     usar esta extensi&oacute;n en lugar de la extensi&oacute;n <link
     linkend="ref.oracle">antigua de Oracle</link> siempre que sea
     posible.
    </para>
   </section>

   <section id="oci8.requirements">
    &reftitle.required;
   <para>
    Es necesario contar con las bibliotecas de cliente Oracle para
    usar esta extensi&oacute;n. Los usuarios de Windows necesitan por
    lo menos la versi&oacute;n 8.1 de Oracle para usar
    <filename>php_oci8.dll</filename>.
   </para>
   <para>
    Antes de usar esta extensi&oacute;n, aseg&uacute;rese de haber
    configurado apropiadamente sus variables de entorno Oracle para
    que correspondan con el usuario de Oracle, as&iacute; como su
    usuario del demonio web. Las variables que necesita definir son
    las siguientes:
    <itemizedlist>
     <listitem>
      <simpara>
       ORACLE_HOME
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       ORACLE_SID
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       LD_PRELOAD
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       LD_LIBRARY_PATH
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       NLS_LANG
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       ORA_NLS33
      </simpara>
     </listitem>
    </itemizedlist>
   </para>
   <para>
    Despu&eacute;s de definir las variables de entorno para su usuario
    de servidor web, aseg&uacute;rese tambi&eacute;n de agregar al
    usuario del servidor web (nobody, www) al grupo oracle.
   </para>
   <note>
    <title>Si su servidor web no arranca, o falla al arrancar</title>
    <para>
     Verifique que Apache est&eacute; enlazado con la biblioteca
     pthread:
    </para>
    <para>
     <informalexample>
      <screen>
<![CDATA[
# ldd /www/apache/bin/httpd 
    libpthread.so.0 => /lib/libpthread.so.0 (0x4001c000)
    libm.so.6 => /lib/libm.so.6 (0x4002f000)
    libcrypt.so.1 => /lib/libcrypt.so.1 (0x4004c000)
    libdl.so.2 => /lib/libdl.so.2 (0x4007a000)
    libc.so.6 => /lib/libc.so.6 (0x4007e000)
    /lib/ld-linux.so.2 => /lib/ld-linux.so.2 (0x40000000)
]]>
      </screen>
     </informalexample>
    </para>
    <para>
     Si libpthread no se encuentra en la lista, necesita re-instalar
     Apache:
    </para>
    <para>
     <informalexample>
      <screen>
<![CDATA[
# cd /usr/src/apache_1.3.xx
# make clean
# LIBS=-lpthread ./config.status
# make
# make install
]]>
      </screen>
     </informalexample>
    </para>
    <para>
     Por favor note que en algunos sistemas, como UnixWare, se trata
     de libthread en lugar de libpthread. PHP y Apache deben
     configurarse con EXTRA_LIBS=-lthread.
    </para>
   </note>
   </section>

   &reference.oci8.configure;

   <section id="oci8.configuration">
    &reftitle.runtime;
    &no.config;
   </section>

   <section id="oci8.resources">
    &reftitle.resources;
    <para>
    </para>
   </section>

   &reference.oci8.constants;

   <section id="oci8.examples">
   &reftitle.examples;
    <para>
    <example>
     <title>Consejos OCI</title>
      <programlisting role="php">
<![CDATA[
<?php
// por sergo arroba bacup punto ru

// Use la opcion OCI_DEFAULT en el comando de ejecucion para aplazar
// la ejecucion
OCIExecute($sentencia, OCI_DEFAULT);

// para recuperar datos use (despues de fetch):

$resultado = OCIResult($sentencia, $n);
if (is_object($result)) $resultado = $resultado->load();

// Para una sentencia INSERT o UPDATE use:

$sql = "insert into tabla (campo1, campo2) values (campo1 = 'valor',
 campo2 = empty_clob()) returning campo2 into :campo2";
OCIParse($con, $sql);
$clob = OCINewDescriptor($con, OCI_D_LOB);
OCIBindByName($sentencia, ":campo2", &$clob, -1, OCI_B_CLOB);
OCIExecute($sentencia, OCI_DEFAULT);
$clob->save("cualquier texto");
OCICommit($con);

?>
]]>
     </programlisting>
    </example>
    </para>
    <para>
     Es posible acceder f&aacute;cilmente a procedimientos almacenados
     en la misma forma en que lo har&iacute;a desde la l&iacute;nea de
     comandos.
    <example>
     <title>Uso de Procedimientos Almacenados</title>
      <programlisting role="php">
<![CDATA[
<?php
// por webmaster arroba remoterealty punto com
$sth = OCIParse($dbh, "begin proc_nueva_dir( :id_direccion, '$nombre',
 '$apellido', '$companyia', '$dir1', '$dir2', '$ciudad', '$estado',
 '$cod_postal', '$pais', :cod_error );end;");

// Esto llama al procedimiento almacenado proc_nueva_dir, en donde
// :id_direccion es una variable de entrada/salida y :cod_error es una
// variable de salida.
// Entonces crea la vinculacion:

   OCIBindByName($sth, ":id_direccion", $id_direccion, 10);
   OCIBindByName($sth, ":cod_error", $cod_error, 10);
   OCIExecute($sth);

?>
]]>
      </programlisting>
    </example>
    </para>
   </section>

  </partintro>

&reference.oci8.functions;

 </reference>
<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"../../../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
