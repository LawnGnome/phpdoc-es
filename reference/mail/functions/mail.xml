<?xml version="1.0" encoding="utf-8"?>
<!-- $Revision: 1.10 $ -->
<!-- EN-Revision: 1.37 Maintainer: lboshell Status: ready -->
<refentry xml:id="function.mail" xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">
 <refnamediv>
  <refname>mail</refname>
  <refpurpose>Enviar correo</refpurpose>
 </refnamediv>

 <refsect1 role="description">
  &reftitle.description;
  <methodsynopsis>
   <type>bool</type><methodname>mail</methodname>
   <methodparam><type>string</type><parameter>para</parameter></methodparam>
   <methodparam><type>string</type><parameter>asunto</parameter></methodparam>
   <methodparam><type>string</type><parameter>mensaje</parameter></methodparam>
   <methodparam choice="opt"><type>string</type><parameter>cabeceras_adicionales</parameter></methodparam>
   <methodparam choice="opt"><type>string</type><parameter>parametros_adicionales</parameter></methodparam>
  </methodsynopsis>
  <para>
   Envía un correo electrónico.
  </para>
 </refsect1>

 <refsect1 role="parameters">
  &reftitle.parameters;
  <para>
   <variablelist>
    <varlistentry>
     <term><parameter>para</parameter></term>
     <listitem>
      <para>
       Recipiente, o recipientes del correo.
      </para>
      <para>
       El formato de esta cadena debe ser compatible con el documento <link
       xlink:href="&url.rfc;2822">RFC 2822</link>. Algunos ejemplos son:
       <simplelist>
        <member>usuario@example.com</member>
        <member>usuario@example.com, otrousuario@example.com</member>
        <member>Usuario &lt;usuario@example.com&gt;</member>
        <member>Usuario &lt;usuario@example.com&gt;, Otro Usuario
        &lt;otrousuario@example.com&gt;</member>
       </simplelist>
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><parameter>asunto</parameter></term>
     <listitem>
      <para>
       Asunto del correo electrónico a ser enviado.
      </para>
      <caution>
       <para>
        Éste no debe contener caracteres de salto de línea, o es posible que
        el correo no sea enviado apropiadamente.
       </para>
      </caution>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><parameter>mensaje</parameter></term>
     <listitem>
      <para>
       Mensaje a ser enviado.
      </para>
      <para>
       Cada línea debe ser sepadarada con un caracter LF (\n). Las líneas no
       deberían exceder los 70 caracteres.
      </para>
      <caution>
       <para>
        (Sólo en Windows) Cuando PHP sostiene comunicación con el servidor
        SMTP directamente, si un punto es encontrado al comienzo de la
        línea, éste es removido. Para contrarestar este comportamiento,
        reemplace estas ocurrencias con dos puntos.
        <programlisting role="php">
<![CDATA[
<?php
$texto = str_replace("\n.", "\n..", $texto);
?>
]]>
        </programlisting>
       </para>
      </caution>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><parameter>cabeceras_adicionales</parameter> (opcional)</term>
     <listitem>
      <para>
       Cadena a ser insertada al final de la cabecera de correo electrónico.
      </para>
      <para>
       Por lo general, este parámetro es usado para agregar cabeceras extra
       (From, Cc y Bcc). Múltiples cabeceras extra deben ser separadan con
       una secuencia CRLF (\r\n).
      </para>
      <note>
       <para>
        Cuando envíe correo, el mensaje <emphasis>debe</emphasis> contener
        una cabecera <literal>From</literal>. Ésta puede definirse con el
        parámetro <parameter>cabeceras_adicionales</parameter>, o puede
        definirse un valor predeterminado en &php.ini;.
       </para>
       <para>
        No hacer esto resultará en un mensaje de error similar a
        <literal>Warning: mail(): "sendmail_from" not set in php.ini or
        custom "From:" header missing</literal>. La cabecera
        <literal>From</literal> define también
        <literal>Return-Path</literal> bajo Windows.
       </para>
      </note>
      <note>
       <para>
        Si los mensajes no son recibidos, intente usar un caracter LF (\n)
        solamente. Algunos agentes de transferencia de correo de pobre
        calidad en Unix reemplazan LF por CRLF automáticamente (lo cual
        conlleva a caracteres CR dobles si se usa CRLF). Esto debe ser usado
        como último recurso, ya que no es compatible con la especificación
        en <link xlink:href="&url.rfc;2822">RFC 2822</link>.
       </para>
      </note>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><parameter>parametros_adicionales</parameter> (opcional)</term>
     <listitem>
      <para>
       El parámetro <parameter>parametros_adicionales</parameter> puede ser
       usado para pasar un parámetro extra al programa configurado para ser
       usado cuando se envíe correo mediante la opción de configuración
       <literal>sendmail_path</literal>. Por ejemplo, este parámetro puede
       usarse para definir la dirección de sobre del origen cuando se usa
       sendmail con la opción <literal>-f</literal>.
      </para>
      <para>
       El usuario bajo el que corre su servidor web debe ser agregado como
       un usuario confiable en la configuración de sendmail para prevenir
       que se agregue una cabecera 'X-Warning' a los mensajes cuando el
       origen de sobre (-f) sea definido usando este método. Para usuarios
       de sendmail, este archivo es
       <filename>/etc/mail/trusted-users</filename>.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </para>
 </refsect1>

 <refsect1 role="returnvalues">
  &reftitle.returnvalues;
  <para>
   Devuelve &true; si el correo fue aceptado satisfactoriamente para su
   envío, o &false; de lo contrario.
  </para>
  <para>
   Es importante notar que solo porque el correo sea aceptado para su envio
   NO quiere decir que el correo realmente vaya a llegar a su destino
   planeado.
  </para>
 </refsect1>

 <refsect1 role="changelog">
  &reftitle.changelog;
  <para>
   <informaltable>
    <tgroup cols="2">
     <thead>
      <row>
       <entry>&Version;</entry>
       <entry>&Description;</entry>
      </row>
     </thead>
     <tbody>
      <row>
       <entry>4.3.0 (Sólo en Windows)</entry>
       <entry>
        Todas las cabeceras personalizadas (como From, Cc, Bcc y Date) son
        soportadas, y no son sensibles a mayúsculas y minúsculas). (Dado que
        las cabeceras personalizadas no son interpretadas por el MTA en
        primer lugar, sino interpretadas por PHP, PHP &lt; 4.3 sólo
        soportaba el elemento de cabecera Cc y era sensible a mayúsculas y
        minúsculas).
       </entry>
      </row>
      <row>
       <entry>4.2.3</entry>
       <entry>
        El parámetro <parameter>parametros_adicionales</parameter> es
        deshabilitado en <link linkend="ini.safe-mode">modo seguro</link> y
        la función <function>mail</function> producirá un mensaje de
        advertencia y devolverá &false; cuando sea usado.
       </entry>
      </row>
      <row>
       <entry>4.0.5</entry>
       <entry>
        El parámetro <parameter>parametros_adicionales</parameter> fue
        agregado.
       </entry>
      </row>
     </tbody>
    </tgroup>
   </informaltable>
  </para>
 </refsect1>

 <refsect1 role="examples">
  &reftitle.examples;
  <para>
   <example>
    <title>Envío de correo.</title>
    <para>
     Uso de <function>mail</function> para enviar un correo simple:
    </para>
    <programlisting role="php">
<![CDATA[
<?php
// El mensaje
$mensaje = "Línea 1\nLínea 2\nLínea 3";

// En caso de que cualquier línea tenga más de 70 caracteres, habría
// que usar wordwrap()
$mensaje = wordwrap($mensaje, 70);

// Enviar
mail('cafeinado@example.com', 'Mi Asunto', $mensaje);
?>
]]>
    </programlisting>
   </example>
   <example>
    <title>Envío de correo con cabeceras extra.</title>
    <para>
     La adición de cabeceras básicas, que le indican al MUA las direcciones
     From y Reply-To:
    </para>
    <programlisting role="php">
<![CDATA[
<?php
$para      = 'nadie@example.com';
$asunto    = 'el asunto';
$mensaje   = 'hola';
$cabeceras = 'From: webmaster@example.com' . "\r\n" .
    'Reply-To: webmaster@example.com' . "\r\n" .
    'X-Mailer: PHP/' . phpversion();

mail($para, $asunto, $mensaje, $cabeceras);
?>
]]>
    </programlisting>
   </example>
   <example>
    <title>Envío de correo con un parámetro de línea de comandos
    adicional.</title>
    <para>
     El parámetro <parameter>parametros_adicionales</parameter> puede ser
     usado para pasar un parámetro adicional al programa configurado para
     usarse cuando se envía correo con <literal>sendmail_path</literal>.
    </para>
    <programlisting role="php">
<![CDATA[
<?php
mail('nadie@example.com', 'el asunto', 'el mensaje', null,
   '-fwebmaster@example.com');
?>
]]>
    </programlisting>
   </example>
   <example>
    <title>Envío de correo electrónico HTML</title>
    <para>
     También es posible enviar correo electrónico en formato HTML con
     <function>mail</function>.
    </para>
    <programlisting role="php">
<![CDATA[
<?php
// múltiples recipientes
$para  = 'aidan@example.com' . ', '; // note la coma
$para .= 'wez@example.com';

// asunto
$asunto = 'Recordatorios de Cumpleaños para Agosto';

// mensaje
$mensaje = '
<html>
<head>
  <title>Recordatorios de Cumpleaños para Agosto</title>
</head>
<body>
  <p>¡Aquí están los cumpleaños que vienen en Agosto!</p>
  <table>
    <tr>
      <th>Persona</th><th>Día</th><th>Mes</th><th>Año</th>
    </tr>
    <tr>
      <td>Juan</td><td>3</td><td>Agosto</td><td>1970</td>
    </tr>
    <tr>
      <td>Sandra</td><td>17</td><td>Agosto</td><td>1973</td>
    </tr>
  </table>
</body>
</html>
';

// Para enviar correo HTML, la cabecera Content-type debe definirse
$cabeceras  = 'MIME-Version: 1.0' . "\r\n";
$cabeceras .= 'Content-type: text/html; charset=iso-8859-1' . "\r\n";

// Cabeceras adicionales
$cabeceras .= 'To: María <maria@example.com>, Kelly <kelly@example.com>' . "\r\n";
$cabeceras .= 'From: Recordatorio de Cumpleaños <recordatorio@example.com>' . "\r\n";
$cabeceras .= 'Cc: archivo@example.com' . "\r\n";
$cabeceras .= 'Bcc: chequeo@example.com' . "\r\n";

// Enviarlo
mail($para, $asunto, $mensaje, $cabeceras);
?>
]]>
    </programlisting>
    <para>
     <note>
      <para>
       Si desea enviar HTML u otros correos complejos, es recomendable usar
       el paquete PEAR <link
       xlink:href="&url.pear.package;Mail_Mime">PEAR::Mail_Mime</link>.
      </para>
     </note>
    </para>
   </example>
  </para>
 </refsect1>

 <refsect1 role="notes">
  &reftitle.notes;
  <note>
   <para>
    La implementación en Windows de <function>mail</function> difiere en
    varias formas de la implementación en Unix. Primero, no usa un binario
    local para componer mensajes, en su lugar opera directamente sobre
    sockets, lo que quiere decir que se requiere de un
    <literal>MTA</literal> que escuche sobre un socket de red (el cual puede
    estar en el host local o en una máquina remota).
   </para>
   <para>
    Segundo, las cabeceras personalizadas como <literal>From:</literal>,
    <literal>Cc:</literal>, <literal>Bcc:</literal> y
    <literal>Date:</literal> <emphasis role="strong">no</emphasis> son
    interpretadas por el <literal>MTA</literal> en primera instancia, son
    interpretadas por PHP.
   </para>
   <para>
    Por lo anterior, el parámetro <parameter>para</parameter> no debería ser
    una dirección en la forma &quot;Algo &lt;alguien@example.com&gt;&quot;.
    Puede que el comando de correo no interprete apropiadamente ésto cuando
    se comunique con el MTA.
   </para>
  </note>

  <note>
   <para>
    Es posible enviar correo electrónico con archivos adjuntos y tipos
    especiales de contenido (p.ej. HTML) usando esta función. Esto se
    consigue mediante el uso de codificación MIME - para más información,
    vea este <link xlink:href="&url.email.mime.zend;">artículo de Zend</link> o
    las <link xlink:href="&url.pear.package;Mail_Mime">Clases Mime PEAR</link>.
   </para>
  </note>

  <note>
   <para>
    Cabe anotar que la función <function>mail</function> no es recomendable
    para el envío de correo electrónico en volumen por medio de un ciclo.
    Esta función abre y cierra un socket SMTP para cada correo, por lo que
    no resulta muy eficiente.
   </para>
   <para>
    Para el envío de grandes cantidades de correo electrónico, vea los
    paquetes <link xlink:href="&url.pear.package;Mail">PEAR::Mail</link> y <link
    xlink:href="&url.pear.package;Mail_Queue">PEAR::Mail_Queue</link>.
   </para>
  </note>

  <note>
   <para>
    Los siguientes documentos RFC pueden resultar útiles: <link
    xlink:href="&url.rfc;1896">RFC 1896</link>, <link xlink:href="&url.rfc;2045">RFC
    2045</link>, <link xlink:href="&url.rfc;2046">RFC 2046</link>, <link
    xlink:href="&url.rfc;2047">RFC 2047</link>, <link xlink:href="&url.rfc;2048">RFC
    2048</link>, <link xlink:href="&url.rfc;2049">RFC 2049</link>, y <link
    xlink:href="&url.rfc;2822">RFC 2822</link>.
   </para>
  </note>
 </refsect1>

 <refsect1 role="seealso">
  &reftitle.seealso;
  <para>
   <simplelist>
    <member><function>imap_mail</function></member>
    <member><link xlink:href="&url.pear.package;Mail">PEAR::Mail</link></member>
    <member><link xlink:href="&url.pear.package;Mail_Mime">PEAR::Mail_Mime</link></member>
   </simplelist>
  </para>
 </refsect1>
</refentry>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"../../../../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
