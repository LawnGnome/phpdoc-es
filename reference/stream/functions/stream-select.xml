<?xml version="1.0" encoding="iso-8859-1"?>
<!-- $Revision: 1.2 $ -->
<!-- EN-Revision: 1.8 Maintainer: lboshell Status: ready -->
  <refentry id="function.stream-select">
   <refnamediv>
    <refname>stream_select</refname>
    <refpurpose>Ejecuta el equivalente al llamado de sistema select()
    en la matriz de secuencias dada, con un tiempo de espera
    especificado por tv_sec y tv_usec</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descripci&oacute;n</title>
     <methodsynopsis>
      <type>int</type><methodname>stream_select</methodname>
      <methodparam><type>array</type><parameter>&amp;lectura</parameter></methodparam>
      <methodparam><type>array</type><parameter>&amp;escritura</parameter></methodparam>
      <methodparam><type>array</type><parameter>&amp;excepcional</parameter></methodparam>
      <methodparam><type>int</type><parameter>tv_sec</parameter></methodparam>
      <methodparam choice="opt"><type>int</type><parameter>tv_usec</parameter></methodparam>
     </methodsynopsis>
    <simpara>
     La funci&oacute;n <function>stream_select</function> acepta una
     matriz de secuencias y espera a que &eacute;stas cambien su
     status. Su operaci&oacute;n es equivalente a la de la
     funci&oacute;n <function>socket_select</function>, excepto que
     act&uacute;a sobre secuencias.
    </simpara>
    <simpara>
     Las secuencias listadas en la matriz
     <parameter>lectura</parameter> ser&aacute;n vigiladas para ver si
     aparecen caracteres disponibles para lectura (o m&aacute;s
     precisamente, para ver si una operaci&oacute;n de lectura no
     producir&aacute; un bloqueo - en particular, un recurso de
     secuencia se encuentra listo tambi&eacute;n al llegar al final
     del archivo, en cuyo caso un llamado a <function>fread</function>
     devolver&aacute; una cadena de longitud cero).
    </simpara>
    <simpara>
     Las secuencias listadas en la matriz
     <parameter>escritura</parameter> ser&aacute;n vigiladas para ver
     si una escritura no crea bloqueos.
    </simpara>
    <simpara>
     Las secuencias listadas en la matriz
     <parameter>excepcional</parameter> ser&aacute;n vigiladas por la
     llegada de datos excepcionales ("out-of-band") de alta prioridad.
    </simpara>
    <note>
     <para>
      Cuando <function>stream_select</function> devuelve un valor, las
      matrices <parameter>lectura</parameter>,
      <parameter>escritura</parameter> y
      <parameter>excepcional</parameter> son modificadas para indicar
      cu&aacute;les recursos de secuencia modificaron su status en
      realidad.
     </para>
    </note>
    <simpara>
     Los par&aacute;metros <parameter>tv_sec</parameter> y
     <parameter>tv_usec</parameter>, juntos forman el par&aacute;metro
     <emphasis>tiempo de espera</emphasis>,
     <parameter>tv_sec</parameter> especifica el n&uacute;mero de
     segundos, mientras que <parameter>tv_usec</parameter> el
     n&uacute;mero de microsegundos. El <emphasis>tiempo de
     espera</emphasis> es un l&iacute;mite superior sobre la cantidad
     de tiempo que <function>stream_select</function> esperar&aacute;
     antes de devolver un valor. Si tanto
     <parameter>tv_sec</parameter> como <parameter>tv_usec</parameter>
     son definidos como <literal>0</literal>,
     <function>stream_select</function> no esperar&aacute; por datos -
     en su lugar devolver&aacute; un valor inmediatamente, indicando
     el status actual de las secuencias. Si
     <parameter>tv_sec</parameter> es &null;
     <function>stream_select</function> puede crear un bloqueo
     indefinidamente, y s&oacute;lo devolver&aacute; un valor cuando
     ocurra un evento en alguna de las secuencias vigiladas (o si una
     se&ntilde;al interrumpe el llamado de sistema).
    </simpara>
    <simpara>
     En caso de &eacute;xito, <function>stream_select</function>
     devuelve el n&uacute;mero de recursos de secuencia modificados
     contenidos en las matrices, que puede ser cero si el tiempo de
     espera expira antes de que algo interesante suceda. En caso de
     fallo, el valor &false; es devuelto y se genera una advertencia
     (esto puede pasar si el llamado de sistema es interrumpido por
     una se&ntilde;al entrante).
    </simpara>

    <warning>
     <para>
      El uso de un valor de tiempo de espera de <literal>0</literal>
      le permite consultar el status de las secuencias de forma
      instant&aacute;nea, sin embargo, NO es buena idea usar un valor
      de tiempo de espera de <literal>0</literal> en un ciclo, dado
      que causar&aacute; que su script consuma mucho tiempo de CPU.
     </para>
     <para>
      Es mucho mejor especificar un valor de tiempo de espera de
      algunos pocos segundos, aunque si necesita hacer chequeos y
      ejecutar otro segmento de c&oacute;digo concurrentemente, usar
      un valor de tiempo de espera de por lo menos
      <literal>200000</literal> microsegundos le ayudar&aacute; a
      reducir el uso de CPU de su script.
     </para>
     <para>
      Recuerde que el valor de tiempo de espera es el tiempo
      m&aacute;ximo que transcurrir&aacute;;
      <function>stream_select</function> devolver&aacute; un valor tan
      pronto como las secuencias solicitadas se encuentren listas para
      su uso.
     </para>
    </warning>
    <simpara>
     No necesita pasar cada matriz a
     <function>stream_select</function>. Puede dejar de especificarlas
     y usar una matriz vac&iacute;a o &null; en su lugar. Tampoco
     olvide que &eacute;stas matrices son pasadas <emphasis>por
     referencia</emphasis> y ser&aacute;n modificadas despu&eacute;s
     de que <function>stream_select</function> devuelva un valor.
    </simpara>
    <para>
     Este ejemplo revisa si han llegado datos para lectura ya sea en
     <parameter>$secuencia1</parameter> o en
     <parameter>$secuencia2</parameter>. Dado que el valor de tiempo
     de espera es <literal>0</literal>, la funci&oacute;n
     retornar&aacute; inmediatamente:
     <programlisting role="php">
<![CDATA[
<?php
/* Preparar la matriz de lectura */
$lectura = array($secuencia1, $secuencia2);

if (false === ($num_secuencias_modificadas = stream_select($lectura, $escritura = NULL, $excepcional = NULL, 0))) {
    /* Gestion de errores */
} elseif ($num_secuencias_modificadas > 0) {
    /* En por lo menos una de las secuencias ha ocurrido algo interesante */
}
?>
]]>
     </programlisting>
    </para>
    <note>
     <para>
      Debido a una limitaci&oacute;n en el Motor Zend actual, no es
      posible pasar un modificador constante como &null; directamente
      como par&aacute;metro a una funci&oacute;n que espera que tal
      par&aacute;metro sea pasado por referencia. En su lugar, use una
      variable temporal o una expresi&oacute;n en donde el miembro del
      lado izquierdo sea una variable temporal:
      <programlisting role="php">
<![CDATA[
<?php
stream_select($l, $e, $ex = NULL, 0);
?>
]]>
     </programlisting>
     </para>
    </note>
    <note>
     <para>
      Aseg&uacute;rese de usar el operador <literal>===</literal>
      cuando efect&uacute;e chequeos de error. Dado que
      <function>stream_select</function> puede devolver 0, la
      comparaci&oacute;n con <literal>==</literal> evaluar&iacute;a a
      &true;:
     <programlisting role="php">
<![CDATA[
<?php
if (false === stream_select($l, $e, $ex = NULL, 0)) {
    echo "stream_select() fall&oacute;\n";
}
?>
]]>
     </programlisting>
     </para>
    </note>
    <note>
     <para>
      Si lee/escribe sobre una secuencia devuelta con las matrices,
      tenga en cuenta que &eacute;stas no necesariemente leen/escriben
      la cantidad completa de datos que usted ha
      solicitado. Prep&aacute;rese para gestionar incluso la
      lectura/escritura de un solo byte.
     </para>
    </note>
    <note>
     <title>Nota de Windows 98</title>
     <para>
      El uso de <function>stream_select</function> sobre un pipe
      devuelto desde <function>proc_open</function> puede causar
      p&eacute;rdida de datos bajo Windows 98.
     </para>
    </note>
    <para>
     Vea tambi&eacute;n
     <function>stream_set_blocking</function>
    </para>
   </refsect1>
  </refentry>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"../../../../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
