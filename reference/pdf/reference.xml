<?xml version="1.0" encoding="iso-8859-1"?>
<!-- $Revision: 1.3 $ -->
 <reference id="ref.pdf">
  <title>Funciones PDF</title>
  <titleabbrev>PDF</titleabbrev>

  <partintro>
   <section id="pdf.intro">
    &reftitle.intro;
    <simpara> 
    Las funciones PDF en PHP pueden crear ficheros PDF utilizando
    la librer&iacute;a PDFlib creada por 
    <ulink url="&url.pdflib.merz;">Thomas Merz</ulink>.
    </simpara>
    <simpara>
    La documentaci&oacute;n en esta secci&oacute;n solamente es una
    descripci&oacute;n de las funciones de la librer&iacute;a PDFlib
    y no deber&iacute;a considerarse una referencia exhaustiva.
    Se ha de consultar la documentaci&oacute;n incluida en el
    c&oacute;digo fuente de la distribuci&oacute;n de PDFlib para
    una completa y detallada explicaci&oacute;n de cada
    funci&oacute;n. Proporciona muy buena descripci&oacute;n
    de las capacidades de PDFlib y contiene actualizada la
    documentaci&oacute;n de todas las funciones.
    </simpara>
    <simpara>
     Todas las funciones de PDFlib y del m&oacute;dulo PHP tienen
     nombres iguales para las funciones y par&aacute;metros. Se
     necesitar&aacute; entender algunos de los conceptos
     b&aacute;sicos de PDF y PostScript para un eficiente uso
     de esta extensi&oacute;n. Todas las longitudes y coordenadas
     se mesuran en puntos PostScript. Generalmente hay 72 puntos
     PostScript por pulgada, pero esto depende de la
     resoluci&oacute;n de salida. Se puede consultar la
     documentaci&oacute;n incluida en la distribuci&oacute;n de
     PDFlib para una detallada explicaci&oacute;n del sistema
     de coordenadas utilizado.
    </simpara>
    <simpara> 
     Hay que tener en cuenta que la mayor&iacute;a de las
     funciones PDF requieren un primer parámetro
     <parameter>pdfdoc</parameter>. En los siguientes 
     <link linkend="pdf.examples">ejemplos</link> hay más
     información.
    </simpara>
    <note>
     <simpara>
      Si se está interesado en alternativas de generadores gratis de PDF que
      no utilizen liberías externas PDF, mirar
      <link linkend="faq.using.freepdf"> este FAQ relacionado</link>.
     </simpara>
    </note>
   </section>

   <section id="pdf.requirements">
    &reftitle.required;
    <para>
     PDFlib está disponible para descargar en
     <ulink url="&url.pdf;">&url.pdf;</ulink>, pero requiere la
     compra de una licencia para uso comercial.  Se requieren
     las librerías <ulink url="&url.jpeg;">JPEG</ulink> y <ulink
     url="&url.tiff;">TIFF</ulink> para compilar esta extensi&oacute;n.
    </para>

   <section id="pdf.oldlibs.hints">
    <title>Compatibilidad con versiones antiguas de PDFlib</title>
    <simpara>
      Cualquier versión de PHP después del 9 de Marzo del 2000 no
      soporta versiones de PDFlib anteriores a la 3.0.
    </simpara>
    <simpara>
      PDFlib 3.0 o superior es compatible desde PHP 3.0.19 en adelante.
    </simpara>
   </section>
   </section>

   &reference.pdf.configure;

   <section id="pdf.configuration">
    &reftitle.runtime;
    &no.config;
   </section>


   <section id="pdf.oldlibs.confusion">
    <title>Confusiones con antiguas versiones de PDFlib</title> 
   <simpara>
    Desde PHP 4.0.5, la extensión PHP para PDFlib es oficialmente
    soportada por PDFlib GmbH. Esto significa que todas las funciones
    descritas en el manual de PDFlib (V3.00 o superior) son
    soportadas por PHP 4 con el mismo funcionamiento y parámetros.
    Sólo los valores devueltos pueden variar en el manual
    PDFlib, ya que PHP adoptó la convención de devolver &false;.
    Por razones de compatibilidad, PDFlib aún soporta las antiguas
    funciones, pero deberían reemplazarlas en sus nuevas versiones.
    PDFlib GmbH no dará soporte a cualquier problema causado
    por el uso de estas funciones obsoletas.
   </simpara>
    <para>
     <table>
      <title>Funciones obsoletas y sus reemplazos.</title>
      <tgroup cols="2">
       <thead>
        <row>
         <entry>Antigua función</entry>
         <entry>Reemplazo</entry>
        </row>
       </thead>
       <tbody>
        <row>
         <entry><function>pdf_put_image</function></entry>
         <entry>Ya no se necesita.</entry>
        </row> 
        <row>
         <entry><function>pdf_execute_image</function></entry>
         <entry>Ya no se necesita.</entry>
        </row> 
        <row>
         <entry><function>pdf_get_annotation</function></entry>
         <entry><function>pdf_get_bookmark</function>
         utilizando los mismos parámetros.</entry>
        </row>
        <row>
         <entry><function>pdf_get_font</function></entry>
         <entry><function>pdf_get_value</function> pasando
         <literal>"font"</literal> como segundo parámetro.</entry>
        </row>
        <row>
         <entry><function>pdf_get_fontsize</function></entry>
         <entry><function>pdf_get_value</function> pasando 
                  <literal>"fontsize"</literal> como segundo parámetro.</entry>
        </row>
        <row>
         <entry><function>pdf_get_fontname</function></entry>
         <entry><function>pdf_get_parameter</function>  pasando    
         <literal>"fontname"</literal> como segundo parámetro.</entry>
        </row>
        <row>
         <entry><function>pdf_set_info_creator</function></entry>
         <entry><function>pdf_set_info</function> pasando    
         <literal>"Creator"</literal> como segundo parámetro.</entry>
        </row>
        <row>
         <entry><function>pdf_set_info_title</function></entry>
         <entry><function>pdf_set_info</function> pasando
         <literal>"Title"</literal> como segundo parámetro.</entry>
        </row>
        <row>
         <entry><function>pdf_set_info_subject</function></entry>
         <entry><function>pdf_set_info</function> pasando
         <literal>"Subject"</literal> como segundo parámetro.</entry>
        </row>
        <row>
         <entry><function>pdf_set_info_author</function></entry>
         <entry><function>pdf_set_info</function> pasando
         <literal>"Author"</literal> como segundo parámetro.</entry>
        </row>
        <row>
         <entry><function>pdf_set_info_keywords</function></entry>
         <entry><function>pdf_set_info</function> pasando
         <literal>"Keywords"</literal> como segundo parámetro.</entry>
        </row>
        <row>
         <entry><function>pdf_set_leading</function></entry>
         <entry><function>pdf_set_value</function> pasando
         <literal>"leading"</literal> como segundo parámetro.</entry>
        </row>
        <row>
         <entry><function>pdf_set_text_rendering</function></entry>
         <entry><function>pdf_set_value</function> pasando
         <literal>"textrendering"</literal> como segundo parámetro.</entry>
        </row>
        <row>
         <entry><function>pdf_set_text_rise</function></entry>
         <entry><function>pdf_set_value</function> pasando
         <literal>"textrise"</literal> como segundo parámetro.</entry>
        </row>
        <row>
         <entry><function>pdf_set_horiz_scaling</function></entry>
         <entry><function>pdf_set_value</function> pasando
         <literal>"horizscaling"</literal> como segundo parámetro.</entry>
        </row>
        <row>
         <entry><function>pdf_set_text_matrix</function></entry>
         <entry>Ya no se necesita.</entry>
        </row>
        <row>
         <entry><function>pdf_set_char_spacing</function></entry>
         <entry><function>pdf_set_value</function> pasando
         <literal>"charspacing"</literal> como segundo parámetro.</entry>
        </row>
        <row>
         <entry><function>pdf_set_word_spacing</function></entry>
         <entry><function>pdf_set_value</function> pasando
         <literal>"wordspacing"</literal> como segundo parámetro.</entry>
        </row>
        <row>
         <entry><function>pdf_set_transition</function></entry>
         <entry><function>pdf_set_parameter</function> pasando
         <literal>"transition"</literal> como segundo parámetro.</entry>
        </row>
        <row>
         <entry><function>pdf_open</function></entry>
         <entry><function>pdf_new</function> más la subsecuente llamada de
          <function>pdf_open_file</function></entry>
        </row>
        <row>
         <entry><function>pdf_set_font</function></entry>
         <entry><function>pdf_findfont</function> más la subsecuente llamada de
          <function>pdf_setfont</function></entry>
        </row>
        <row>
         <entry><function>pdf_set_duration</function></entry>
         <entry><function>pdf_set_value</function> pasando
         <literal>"duration"</literal> como segundo parámetro.</entry>
        </row>
        <row>
         <entry><function>pdf_open_gif</function></entry>
         <entry><function>pdf_open_image_file</function> pasando
         <literal>"gif"</literal> como segundo parámetro.</entry>
        </row>
        <row>
         <entry><function>pdf_open_jpeg</function></entry>
         <entry><function>pdf_open_image_file</function> pasando
         <literal>"jpeg"</literal> como segundo parámetro.</entry>
        </row>
        <row>
         <entry><function>pdf_open_tiff</function></entry>
         <entry><function>pdf_open_image_file</function> pasando
         <literal>"tiff"</literal> como segundo parámetro.</entry>
        </row>
        <row>
         <entry><function>pdf_open_png</function></entry>
         <entry><function>pdf_open_image_file</function> pasando
         <literal>"png"</literal> como segundo parámetro.</entry>
        </row>
        <row>
         <entry><function>pdf_get_image_width</function></entry>
         <entry><function>pdf_get_value</function> pasando
         <literal>"imagewidth"</literal> como segundo parámetro y la
         imágen como tercer parámetro.</entry>
        </row>
        <row>
         <entry><function>pdf_get_image_height</function></entry>
         <entry><function>pdf_get_value</function> pasando
         <literal>"imageheight"</literal> como segundo parámetro y la
         imágen como tercer parámetro.</entry>
        </row>
       </tbody>
      </tgroup>
     </table>
    </para>
   </section>

   <section id="pdf.examples">
    &reftitle.examples;
    <simpara>
     La mayoría de las funciones son bastante fáciles de utilizar.
     La parte más difícil probablemente es la creación de un primer
     documento PDF. El siguiente ejemplo debería ayudar para
     comenzar. El ejemplo crea el fichero <filename>test.pdf</filename>
     en una página. La página contiene el texto "Times Roman outlined"
     en un contorno, con fuente de 30pt.
     El texto también está subrayado.
    </simpara>
    <para>
     <example>
      <title>Creando un documento PDF con PDFlib</title>
      <programlisting role="php">
<![CDATA[
<?php
$pdf = pdf_new();
pdf_open_file($pdf, "test.pdf");
pdf_set_info($pdf, "Author", "Javier Tacon");
pdf_set_info($pdf, "Title", "Test for PHP wrapper of PDFlib 2.0");
pdf_set_info($pdf, "Creator", "See Author");
pdf_set_info($pdf, "Subject", "Testing");
pdf_begin_page($pdf, 595, 842);
pdf_add_outline($pdf, "Page 1");
$font = pdf_findfont($pdf, "Times New Roman", "winansi", 1);
pdf_setfont($pdf, $font, 10);
pdf_set_value($pdf, "textrendering", 1);
pdf_show_xy($pdf, "Times Roman outlined", 50, 750);
pdf_moveto($pdf, 50, 740);
pdf_lineto($pdf, 330, 740);
pdf_stroke($pdf);
pdf_end_page($pdf);
pdf_close($pdf);
pdf_delete($pdf);
echo "<A HREF=getpdf.php>finished</A>";
?>
]]>
      </programlisting>
     </example>

      El script <filename>getpdf.php</filename> simplemente devuelve el
      documento pdf.

     <example>
      <title>Mostrando un documento PDF precalculado</title>
  	  <programlisting role="php">
<![CDATA[
<?php
$len = filesize($filename);
header("Content-type: application/pdf");
header("Content-Length: $len");
header("Content-Disposition: inline; filename=foo.pdf");
readfile($filename);
?>
]]>
      </programlisting>
     </example>
    </para>
    <para>
     La distrubución PDFlib contiene un ejemplo
     más complejo para crear un reloj analógico en
     una página. Aquí se utiliza el método de
     creación en memoria de PDFlib para no tener que crear
     un fichero temporal. El ejemplo se ha convertido a PHP
     desde uno de PDFlib (El mismo ejemplo está
     disponible en la documentación <link
     linkend="ref.cpdf">ClibPDF</link>.)
    </para>
    <para>
     <example>
      <title>Ejemplo pdfclock de la distribución PDFlib</title>
      <programlisting role="php">
<![CDATA[
<?php
$radius = 200;
$margin = 20;
$pagecount = 10;

$pdf = pdf_new();

if (!pdf_open_file($pdf, "")) {
    echo error;
    exit;
};

pdf_set_parameter($pdf, "warning", "true");

pdf_set_info($pdf, "Creator", "pdf_clock.php");
pdf_set_info($pdf, "Author", "Uwe Steinmann");
pdf_set_info($pdf, "Title", "Analog Clock");

while ($pagecount-- > 0) {
    pdf_begin_page($pdf, 2 * ($radius + $margin), 2 * ($radius + $margin));

    pdf_set_parameter($pdf, "transition", "wipe");
    pdf_set_value($pdf, "duration", 0.5);
  
    pdf_translate($pdf, $radius + $margin, $radius + $margin);
    pdf_save($pdf);
    pdf_setrgbcolor($pdf, 0.0, 0.0, 1.0);

    /* minute strokes */
    pdf_setlinewidth($pdf, 2.0);
    for ($alpha = 0; $alpha < 360; $alpha += 6) {
        pdf_rotate($pdf, 6.0);
        pdf_moveto($pdf, $radius, 0.0);
        pdf_lineto($pdf, $radius-$margin/3, 0.0);
        pdf_stroke($pdf);
    }

    pdf_restore($pdf);
    pdf_save($pdf);

    /* 5 minute strokes */
    pdf_setlinewidth($pdf, 3.0);
    for ($alpha = 0; $alpha < 360; $alpha += 30) { 
        pdf_rotate($pdf, 30.0);
        pdf_moveto($pdf, $radius, 0.0);
        pdf_lineto($pdf, $radius-$margin, 0.0);
        pdf_stroke($pdf);
    }

    $ltime = getdate();

    /* draw hour hand */
    pdf_save($pdf);
    pdf_rotate($pdf,-(($ltime['minutes']/60.0)+$ltime['hours']-3.0)*30.0);
    pdf_moveto($pdf, -$radius/10, -$radius/20);
    pdf_lineto($pdf, $radius/2, 0.0);
    pdf_lineto($pdf, -$radius/10, $radius/20);
    pdf_closepath($pdf);
    pdf_fill($pdf);
    pdf_restore($pdf);

    /* draw minute hand */
    pdf_save($pdf);
    pdf_rotate($pdf,-(($ltime['seconds']/60.0)+$ltime['minutes']-15.0)*6.0);
    pdf_moveto($pdf, -$radius/10, -$radius/20);
    pdf_lineto($pdf, $radius * 0.8, 0.0);
    pdf_lineto($pdf, -$radius/10, $radius/20);
    pdf_closepath($pdf);
    pdf_fill($pdf);
    pdf_restore($pdf);

    /* draw second hand */
    pdf_setrgbcolor($pdf, 1.0, 0.0, 0.0);
    pdf_setlinewidth($pdf, 2);
    pdf_save($pdf);
    pdf_rotate($pdf, -(($ltime['seconds'] - 15.0) * 6.0));
    pdf_moveto($pdf, -$radius/5, 0.0);
    pdf_lineto($pdf, $radius, 0.0);
    pdf_stroke($pdf);
    pdf_restore($pdf);

    /* draw little circle at center */
    pdf_circle($pdf, 0, 0, $radius/30);
    pdf_fill($pdf);

    pdf_restore($pdf);

    pdf_end_page($pdf);

    # to see some difference
    sleep(1);
}

pdf_close($pdf);

$buf = pdf_get_buffer($pdf);
$len = strlen($buf);

header("Content-type: application/pdf");
header("Content-Length: $len");
header("Content-Disposition: inline; filename=foo.pdf");
echo $buf;

pdf_delete($pdf);
?>
]]>
      </programlisting>
     </example>
    </para>
   </section>

   <section id="pdf.seealso">
    &reftitle.seealso;
    <note>
     <para>
      Una alternativa de módulo PHP para la creación
      de documentos PDF basados en 
      <ulink url="&url.cpdf;">FastIO's</ulink> ClibPDF está
      disponible. Mirar la sección <link linkend="ref.cpdf">ClibPDF</link>
      para más detalles. Tener en cuenta que <link
      linkend="ref.cpdf">ClibPDF</link> tiene alguna diferencia con PDFlib.
     </para>
    </note>
   </section>

  </partintro>

&reference.pdf.functions;

 </reference>
<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"../../../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->

