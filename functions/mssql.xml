<?xml version="1.0" encoding="iso-8859-1"?>
 <reference id="ref.mssql">
  <title>Funciones de Microsoft SQL Server</title>
  <titleabbrev>MS SQL Server</titleabbrev>

  <refentry id="function.mssql-close">
   <refnamediv>
    <refname>mssql_close</refname>
    <refpurpose>cierra una conexi&oacute;n con MS SQL Server</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descripci&oacute;n</title>
    <funcsynopsis>
     <funcprototype>
     <funcdef>int <function>mssql_close</function></funcdef>
     <paramdef>int <parameter>link_identifier</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>Devuleve: &true; si se finaliza con &eacute;xito, &false; si se produce un error
    </para>
    <para> mssql_close() cierra la conexi&oacute;n con una base de datos MS SQL Server que
    est&aacute; asociada al identificador especificado.  Si el identificador no se especifica,
    se asume la &uacute;ltima conexi&oacute;n abierta.
    </para>
    <para> Observe que normalmente esto no es necesario, ya que las conexiones
    no-persistentes abiertas se cierran automaticamente en cuanto finaliza 
    el script.
    </para>
    <para> mssql_close() no cerrar&aacute; conexiones persistentes generadas por
    mssql_pconnect().
    </para>
    <para> Ver tambi&eacute;n: <function>mssql_connect</function>,
                        <function>mssql_pconnect</function>.
    </para> 
   </refsect1>
  </refentry>

  <refentry id="function.mssql-connect">
   <refnamediv>
    <refname>mssql_connect</refname>
    <refpurpose>abre una conexi&oacute;n con MS SQL server</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descripci&oacute;n</title>
    <funcsynopsis>
     <funcprototype>
     <funcdef>int <function>mssql_connect</function></funcdef>
     <paramdef>string <parameter>servername</parameter></paramdef>
     <paramdef>string <parameter>username</parameter></paramdef>
     <paramdef>string <parameter>password</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para> Devuelve: Un identificador de MSSQL si se ejecuta correctamente, o
    &false; si se produce un error.
    </para>
    <para> mssql_connect() establece una conexi&oacute;n con MS SQL server.
    El argumento servername debe ser un nombre de servidor v&aacute;lido, que est&aacute; definido
    en el fichero 'interfaces'.
    </para>
    <para> En caso de hacer una segunda llamada a mssql_connect() con los
    mismos argumentos, no se establecer&aacute; una nueva conexi&oacute;n, sino que se 
    devolver&aacute; el identificador de la conexi&oacute;n establecida anteriormente.
    </para>
    <para> La conexi&oacute;n con el servidor se cerrar&aacute; tan pronto como finalice 
    el script, a menos que se cierre antes, mediante una 
    llamada explicita a la funci&oacute;n <function>mssql_close</function>.
    </para>
    <para>Ver tambi&eacute;n <function>mssql_pconnect</function>, 
                   <function>mssql_close</function>.
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.mssql-data-seek">
   <refnamediv>
    <refname>mssql_data_seek</refname>
    <refpurpose>mueve el puntero interno de las filas</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descripci&oacute;n</title>
    <funcsynopsis>
     <funcprototype>
     <funcdef>int <function>mssql_data_seek</function></funcdef>
     <paramdef>int <parameter>result_identifier</parameter></paramdef>
     <paramdef>int <parameter>row_number</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para> Devuelve: &true; si se ejecuta con &eacute;xito, &false; si falla.
    </para>
    <para> mssql_data_seek() mueve el puntero interno de la consulta 
    MS SQL asociada al result_identifier especificado, para que
    apunte al n&uacute;mero de fila especificada.  La siguiente llamada a
    <function>mssql_fetch_row</function> devolver&aacute; esa fila.
    </para>
    <para> Ver tambi&eacute;n: <function>mssql_data_seek</function>.
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.mssql-fetch-array">
   <refnamediv>
    <refname>mssql_fetch_array</refname>
    <refpurpose>Captura la fila en un array</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descripci&oacute;n</title>
    <funcsynopsis>
     <funcprototype>
     <funcdef>int <function>mssql_fetch_array</function></funcdef>
     <paramdef>int <parameter>result</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para> Devuelve: Un array que corresponde a la fila capturada, o
    &false; si no hay m&aacute;s filas.
    </para>
    <para>
     mssql_fetch_array() es una versi&oacute;n extendida de
     <function>mssql_fetch_row</function>. A¤ade el almacenar los datos
     en los &iacute;ndices num&eacute;ricos del array resultante, tambi&eacute;n almacena
     los datos en &iacute;ndices asociativos, usando los nombres de los campos
     como claves.
    </para>
    <para>
     Una observaci&oacute;n a tener en cuenta es, que usar mssql_fetch_array() NO es
     m&aacute;s lento que usar mssql_fetch_row(), mientras que esta
     provee un valor a¤adido significativo.</para>
    <para>
     Para m&aacute;s detalles, ver tambi&eacute;n
     <function>mssql_fetch_row</function>
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.mssql-fetch-field">
   <refnamediv>
    <refname>mssql_fetch_field</refname>
    <refpurpose>obtiene la informaci&oacute;n de los campos</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descripci&oacute;n</title>
    <funcsynopsis>
     <funcprototype>
     <funcdef>object <function>mssql_fetch_field</function></funcdef>
     <paramdef>int <parameter>result</parameter></paramdef>
     <paramdef>int <parameter>field_offset</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     Devuleve un objeto que contiene informaci&oacute;n de los campos.  
    </para>
    <para>
     mssql_fetch_field() se puede usar para obtener informaci&oacute;n acerca
     de los campos pertenecientes al resultado de una consulta.  Si el par&aacute;metro
     field_offset no es especificado, se devuelve la informaci&oacute;n del siguiente
     campo que todav&iacute;a no ha sido devuelto por mssql_fetch_field().
    </para>
    <para>
     Las propiedades de este objeto son:
    </para>

     <itemizedlist>
      <listitem><simpara>
   name - nombre de la columna.  si la columna es el resultado de una funci&oacute;n, esta propiedad vale #N,
   donde #N es un n&uacute;mero de serie.
       </simpara></listitem>
      <listitem><simpara>
   column_source - la tabla de donde se tom&oacute; la columna
       </simpara></listitem>
      <listitem><simpara>
   max_length - longitud m&aacute;xima de columna
       </simpara></listitem>
      <listitem><simpara>
   numeric - 1 si la columna es num&eacute;rica
       </simpara></listitem> 
     </itemizedlist>

    <para>
     Ver tambi&eacute;n <function>mssql_field_seek</function>
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.mssql-fetch-object">
   <refnamediv>
    <refname>mssql_fetch_object</refname>
    <refpurpose>captura la fila como un objeto</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descripci&oacute;n</title>
    <funcsynopsis>
     <funcprototype>
     <funcdef>int <function>mssql_fetch_object</function></funcdef>
     <paramdef>int <parameter>result</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para> Devuelve: Un objeto con propiedades que se corresponden con la
    fila capturada, o &false; si no hay m&aacute;s filas.
    </para>
    <para> mssql_fetch_object() es parecida a <function>mssql_fetch_array</function>,
    con una diferencia - devuelve un objeto en vez de un array.
    Indirectamente, esto significa que s&oacute;lo se puede acceder a los datos por el
    nombre de los campos, y no por sus posiciones en el objeto
    (los n&uacute;meros no son nombres de propiedades v&aacute;lidas).</para>
    <para>
    La funci&oacute;n es id&eacute;ntica a <function>mssql_fetch_array</function>, y casi
    tan r&aacute;pida como <function>mssql_fetch_row</function> (la diferencia es
    insignificante).
    </para>
    <para> Ver tambi&eacute;n: <function>mssql_fetch-array</function> and
                     <function>mssql_fetch-row</function>.
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.mssql-fetch-row">
   <refnamediv>
    <refname>mssql_fetch_row</refname>
    <refpurpose>obtiene la fila como un array numerado</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descripci&oacute;n</title>
    <funcsynopsis>
     <funcprototype>
     <funcdef>array <function>mssql_fetch_row</function></funcdef>
     <paramdef>int <parameter>result</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para> Devuleve: Un array que corresponde a la fila capturada, o
    &false; si no hay m&aacute;s filas.
    </para>
    <para>
     mssql_fetch_row() captura una fila de datos pertenecientes al resultado
     asociado con el identificador de resultado especificado.  La fila es
     devuelta como un array.  Cada columna de resultados es almacenada en una
     posici&oacute;n del array, comenzando en la posici&oacute;n 0.
    </para>
    <para>
     Siguientes llamadas a mssql_fetch_rows() devolver&iacute;an las filas siguientes
     del result set, o &false; si no hay mas filas.
    </para>
    <para>
     Ver tambi&eacute;n: <function>mssql_fetch_array</function>,
               <function>mssql_fetch_object</function>,
               <function>mssql_data_seek</function>,
               <function>mssql_fetch_lengths</function>, and
               <function>mssql_result</function>.
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.mssql-field-seek">
   <refnamediv>
    <refname>mssql_field_seek</refname>
    <refpurpose>set field offset</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descripci&oacute;n</title>
    <funcsynopsis>
     <funcprototype>
     <funcdef>int <function>mssql_field_seek</function></funcdef>
     <paramdef>int <parameter>result</parameter></paramdef>
     <paramdef>int <parameter>field_offset</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     Se posiciona en el campo especificado por el par&aacute;metro field_offset.
     Si la siguiente llamada a <function>mssql_fetch_field</function> no incluye
     el par&aacute;metro field_offset, lo que devuelve la funci&oacute;n es el campo.</para>
    <para></para>
    <para>
     Ver tambi&eacute;n: <function>mssql_fetch_field</function>.</para>
   </refsect1>
  </refentry>

  <refentry id="function.mssql-free-result">
   <refnamediv>
    <refname>mssql_free_result</refname>
    <refpurpose>libera de la memoria el resultado de una consulta</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descripci&oacute;n</title>
    <funcsynopsis>
     <funcprototype>
     <funcdef>int <function>mssql_free_result</function></funcdef>
     <paramdef>int <parameter>result</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     <function>mssql_free_result</function> s&oacute;lo se necesita llamarla
     si le preocupa el estar usando mucha memoria mientras se est&aacute; ejecutando
     el script. Toda el resultado en memoria ser&aacute; liberado automaticamente cuando
     finalice el script, puede llamar a <function>mssql_free_result</function>
     con el identificador de la consulta como argumento y la consulta asociada
     ser&aacute; liberada de la memoria.
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.mssql-num-fields">
   <refnamediv>
    <refname>mssql_num_fields</refname>
    <refpurpose>obtiene el n&uacute;mero de campos de la consulta</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descripci&oacute;n</title>
    <funcsynopsis>
     <funcprototype>
     <funcdef>int <function>mssql_num_fields</function></funcdef>
     <paramdef>int <parameter>result</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para> mssql_num_fields() devuelve el n&uacute;mero de campos de la consulta o
    result set.
    </para>
    <para> 
     Ver tambi&eacute;n:  
     <function>mssql_db_query</function>, 
     <function>mssql_query</function>, 
     <function>mssql_fetch_field</function>, 
     <function>mssql_num_rows</function>.
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.mssql-num-rows">
   <refnamediv>
    <refname>mssql_num_rows</refname>
    <refpurpose>obtiene el n&uacute;mero de filas de la consulta</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descripci&oacute;n</title>
    <funcsynopsis>
     <funcprototype>
     <funcdef>int <function>mssql_num_rows</function></funcdef>
     <paramdef>string <parameter>result</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para>
     mssql_num_rows() devuelve el n&uacute;mero de filas de la consulta o result set.
    </para>
    <para>
     Ver tambi&eacute;n:  
     <function>mssql_db_query</function>, 
     <function>mssql_query</function> and, 
     <function>mssql_fetch_row</function>.
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.mssql-pconnect">
   <refnamediv>
    <refname>mssql_pconnect</refname>
    <refpurpose>abre una conexi&oacute;n persistenete con MS SQL</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descripci&oacute;n</title>
    <funcsynopsis>
     <funcprototype>
     <funcdef>int <function>mssql_pconnect</function></funcdef>
     <paramdef>string <parameter>servername</parameter></paramdef>
     <paramdef>string <parameter>username</parameter></paramdef>
     <paramdef>string <parameter>password</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para> 
     Devuelve: Un identificador persistente postivo si no hay error,
     o &false; si se produce alguno</para>
    <para>
     mssql_pconnect() funciona de la misma forma que <function>mssql_connect</function>
     aunque con dos grandes diferencias.</para>
    <para> 
     La primera es que cuando intenta conectar, la funci&oacute;n intentar&aacute; encontrar un
     enlace (persistente) que ya est&eacute; abierto en el mismo ordenador, nombre de usuario y
     contrase¤a.  Si lo encuentra, la funcion devolver&aacute; el identificador de esta
     en vez de abrir una nueva conexi&oacute;n.</para>
    <para> 
     Y la segunda, la conexi&oacute;n con el servidor no se cerrar&aacute; cuando finalice 
     la ejecuci&oacute;n del script.  En vez de esto, el enlace permanecer&aacute; 
     abierto para un uso futuro. (<function>mssql_close</function> no cerrar&aacute;
     enlaces establecidos por <literal>mssql_pconnect()</literal>).</para>
    <para> 
     Por consiguiente, este tipo de enlace es llamado 'persistente'.</para>

   </refsect1>
  </refentry>

  <refentry id="function.mssql-query">
   <refnamediv>
    <refname>mssql_query</refname>
    <refpurpose>envia una consulta MS SQL</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descripci&oacute;n</title>
    <funcsynopsis>
     <funcprototype>
     <funcdef>int <function>mssql_query</function></funcdef>
     <paramdef>string <parameter>query</parameter></paramdef>
     <paramdef>int <parameter>link_identifier</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para> Devuelve: Un identificado de resultado valido si no hay error, o
    &false; en caso contrario.
    </para>
    <para> mssql_query() envia una petici&oacute;n de consulta a la base de datos 
    activa en el servidor asociada al identificador de enlace especificado.
    Si el identificador del enlace no es especificado, se asume como abierto el 
    &uacute;ltimo enlace.  Si no hay ning&uacute;n enlace abierto, la funci&oacute;n intenta establecer
    un enlace como si <function>mssql_connect</function> hubiera sido llamada,
    y lo usa.
    </para>
    <para>
     Ver tambi&eacute;n:  
     <function>mssql_db_query</function>, 
     <function>mssql_select_db</function>, and 
     <function>mssql_connect</function>.
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.mssql-result">
   <refnamediv>
    <refname>mssql_result</refname>
    <refpurpose>get result data</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descripci&oacute;n</title>
    <funcsynopsis>
     <funcprototype>
     <funcdef>int <function>mssql_result</function></funcdef>
     <paramdef>int <parameter>result</parameter></paramdef>
     <paramdef>int <parameter>i</parameter></paramdef>
     <paramdef>mixed <parameter>field</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para> Devuelve: El contenido de la celda en la fila y posici&oacute;n
    del result set especificado.
    </para>
    <para>
     mssql_result() devuelve el contenido de una celda del result set.
     El parametro field puede ser la posici&oacute;n del campo, o el nombre del campo
     o bi&eacute;n nombretabla.nombrecampo.  Si el nombre de la columna ha sido renombrado
     ('select foo as bar from...'), use el alias en vez del nombre de la 
     columna.
    </para>
    <para>
     Trabajando con result sets de gran tama¤o, deber&iacute;a considerar el uso
     de una de las funciones que capturan una fila completa (especificadas abajo).
     Como estas funciones devuelven el contenido de m&uacute;ltiples celdas en una s&oacute;la
     llamada, estas son MUCHO m&aacute;s r&aacute;pidas que mssql_result().  Tambi&eacute;n,
     observe que especificar una posici&oacute;n n&uacute;merica para el argumento field es mucho
     mas r&aacute;pido que especificar el nombre de un campo o utilizar la forma
     nombretabla.nombrecampo como argumento.
    </para>
    <para>
     Alternativas recomendadas para mayor rendimiento :
     <function>mssql_fetch_row</function>, 
     <function>mssql_fetch_array</function>, y
     <function>mssql_fetch_object</function>.
    </para>
   </refsect1>
  </refentry>

  <refentry id="function.mssql-select-db">
   <refnamediv>
    <refname>mssql_select_db</refname>
    <refpurpose>selecciona una base de datos MS SQL</refpurpose>
   </refnamediv>
   <refsect1>
    <title>Descripci&oacute;n</title>
    <funcsynopsis>
     <funcprototype>
     <funcdef>int <function>mssql_select_db</function></funcdef>
     <paramdef>string <parameter>database_name</parameter></paramdef>
     <paramdef>int <parameter>link_identifier</parameter></paramdef>
     </funcprototype>
    </funcsynopsis>
    <para> Devuelve: &true; si todo va bi&eacute;n, &false; si se produce un error
    </para>
    <para> mssql_select_db() selecciona como base de datos activa del servidor,
    la que est&aacute; asociada al identificador de enlace especificado.  Si no se 
    especifica nig&uacute;n identificador, se asume el &uacute;ltimo enlace.
    Si no hay ning&uacute;n enlace abierto, la funci&oacute;n intentar&aacute; establecer un enlace 
    como si se llamara a la funci&oacute;n <function>mssql_connect</function>, y lo usa.
    </para>
    <para>
     Cada llamada a <function>mssql_query</function> ser&aacute; realizada sobre
     la base de datos activa.
    </para>
    <para> Ver tambi&eacute;n:
     <function>mssql_connect</function>, 
     <function>mssql_pconnect</function>, y
     <function>mssql_query</function>
    </para>
   </refsect1>
  </refentry>

</reference>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
-->
